{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap fd23408fe4efac681638","webpack:///./src/index.js","webpack:///./src/api.js","webpack:///./src/app.js","webpack:///./src/babbage.js","webpack:///./src/chart.js","webpack:///./src/crosstab.js","webpack:///./src/facts.js","webpack:///./src/pager.js","webpack:///./src/panel.js","webpack:///./src/sankey.js","webpack:///./src/treemap.js","webpack:///./src/util.js","webpack:///./src/workspace.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,O;ACVA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,uBAAe;AACf;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;;;;;;;;ACtCA,qBAAQ,CAAR;AACA,qBAAQ,CAAR;AACA,qBAAQ,CAAR;AACA,qBAAQ,CAAR;AACA,qBAAQ,CAAR;AACA,qBAAQ,CAAR;AACA,qBAAQ,CAAR;AACA,qBAAQ,CAAR;AACA,qBAAQ,CAAR;AACA,qBAAQ,EAAR;AACA,qBAAQ,EAAR;AACA,qBAAQ,EAAR;;AAEA,QAAO,OAAP,GAAiB,WAAjB,C;;;;;;;;ACZA,WAAU,OAAV,CAAkB,YAAlB,EAAgC,CAAC,OAAD,EAAU,IAAV,EAAgB,eAAhB,EAAiC,UAAS,KAAT,EAAgB,EAAhB,EAAoB,aAApB,EAAmC;AAClG,OAAI,QAAQ,EAAR,CAD8F;;AAGlG,OAAI,SAAS,SAAT,MAAS,CAAS,QAAT,EAAmB,IAAnB,EAAyB,IAAzB,EAA+B;AAC1C,SAAI,MAAM,SAAS,KAAT,EAAN;SACA,MAAM,IAAI,QAAJ,CAAa,GAAb,IAAoB,IAAI,KAAJ,CAAU,CAAV,EAAa,IAAI,MAAJ,GAAa,CAAb,CAAjC,GAAmD,GAAnD;SACN,MAAM,MAAM,SAAN,GAAkB,IAAlB,GAAyB,GAAzB,GAA+B,IAA/B,CAHgC;AAI1C,YAAO,GAAP,CAJ0C;IAA/B,CAHqF;;AAUlG,OAAI,YAAY,SAAZ,SAAY,CAAS,GAAT,EAAc;AAC5B,SAAI,CAAC,QAAQ,SAAR,CAAkB,MAAM,GAAN,CAAlB,CAAD,EAAgC;AAClC,aAAM,GAAN,IAAa,MAAM,GAAN,CAAU,GAAV,CAAb,CADkC;MAApC;AAGA,YAAO,MAAM,GAAN,CAAP,CAJ4B;IAAd,CAVkF;;AAiBlG,OAAI,WAAW,SAAX,QAAW,CAAS,QAAT,EAAmB,IAAnB,EAAyB;AACtC,YAAO,UAAU,OAAO,QAAP,EAAiB,IAAjB,EAAuB,OAAvB,CAAV,EAA2C,IAA3C,CAAgD,UAAS,GAAT,EAAc;AACnE,WAAI,QAAQ,IAAI,IAAJ,CAAS,KAAT,CADuD;AAEnE,aAAM,IAAN,GAAa,EAAb,CAFmE;AAGnE,aAAM,OAAN,GAAgB,EAAhB,CAHmE;AAInE,aAAM,SAAN,GAAkB,EAAlB,CAJmE;;AAMnE,YAAK,IAAI,CAAJ,IAAS,MAAM,QAAN,EAAgB;AAC5B,aAAI,UAAU,MAAM,QAAN,CAAe,CAAf,CAAV,CADwB;AAE5B,iBAAQ,OAAR,GAAkB,IAAlB,CAF4B;AAG5B,iBAAQ,SAAR,GAAoB,IAApB,CAH4B;AAI5B,eAAM,IAAN,CAAW,QAAQ,GAAR,CAAX,GAA0B,OAA1B,CAJ4B;QAA9B;;AAOA,YAAK,IAAI,CAAJ,IAAS,MAAM,UAAN,EAAkB;AAC9B,aAAI,MAAM,MAAM,UAAN,CAAiB,CAAjB,CAAN,CAD0B;AAE9B,aAAI,OAAJ,GAAc,IAAd,CAF8B;AAG9B,aAAI,SAAJ,GAAgB,IAAhB,CAH8B;AAI9B,eAAM,IAAN,CAAW,IAAI,GAAJ,CAAX,GAAsB,GAAtB,CAJ8B;QAAhC;;AAOA,YAAK,IAAI,EAAJ,IAAU,MAAM,UAAN,EAAkB;AAC/B,aAAI,MAAM,MAAM,UAAN,CAAiB,EAAjB,CAAN,CAD2B;AAE/B,cAAK,IAAI,EAAJ,IAAU,IAAI,UAAJ,EAAgB;AAC7B,eAAI,OAAO,IAAI,UAAJ,CAAe,EAAf,CAAP;eACA,SAAS,KAAK,GAAL,CAAS,OAAT,CAAiB,GAAjB,KAAyB,CAAC,CAAD,CAFT;AAG7B,gBAAK,SAAL,GAAiB,GAAjB,CAH6B;AAI7B,gBAAK,SAAL,GAAiB,cAAc,KAAK,KAAL,CAAd,IAA6B,cAAc,IAAI,KAAJ,CAA3C,CAJY;AAK7B,iBAAM,IAAN,CAAW,KAAK,GAAL,CAAX,GAAuB,IAAvB,CAL6B;AAM7B,iBAAM,OAAN,CAAc,KAAK,GAAL,CAAd,GAA0B,SAAS,IAAI,IAAJ,GAAW,GAAX,GAAiB,IAAI,aAAJ,GAAoB,KAAK,GAAL,CAN3C;AAO7B,iBAAM,SAAN,CAAgB,KAAK,GAAL,CAAhB,GAA4B,SAAS,IAAI,IAAJ,GAAW,GAAX,GAAiB,IAAI,eAAJ,GAAsB,KAAK,GAAL,CAP/C;UAA/B;QAFF;AAYA,cAAO,KAAP,CAhCmE;MAAd,CAAvD,CADsC;IAAzB,CAjBmF;;AAsDlG,OAAI,sBAAsB,SAAtB,mBAAsB,CAAS,QAAT,EAAmB,IAAnB,EAAyB,SAAzB,EAAoC;AAC5D,YAAO,UAAU,OAAO,QAAP,EAAiB,IAAjB,EAAuB,aAAa,SAAb,CAAjC,CAAP,CAD4D;IAApC,CAtDwE;;AA0DlG,OAAI,QAAQ,SAAR,KAAQ,GAAW;AACrB,aAAQ,EAAR,CADqB;IAAX,CA1DsF;;AA8DlG,UAAO;AACL,aAAQ,MAAR;AACA,eAAU,QAAV;AACA,0BAAqB,mBAArB;AACA,YAAO,KAAP;IAJF,CA9DkG;EAAnC,CAAjE,E;;;;;;;;ACDA,KAAI,YAAY,QAAQ,MAAR,CAAe,WAAf,EAA4B,CAAC,qBAAD,CAA5B,CAAZ;;AAEJ,KAAI,mBAAmB,oBAAoB,EAApB;AACvB,kBAAiB,YAAjB,GAAgC,GAAG,MAAH,CAAU,OAAV,CAAhC;AACA,kBAAiB,cAAjB,GAAkC,CAC9B,SAD8B,EACnB,SADmB,EACR,SADQ,EACG,SADH,EACc,SADd,EAE9B,SAF8B,EAEnB,SAFmB,EAER,SAFQ,EAEG,SAFH,EAEc,SAFd,EAG9B,SAH8B,EAGnB,SAHmB,EAGR,SAHQ,EAGG,SAHH,EAGc,SAHd,EAGyB,SAHzB,EAI9B,SAJ8B,EAInB,SAJmB,EAIR,SAJQ,EAIG,SAJH,EAIc,SAJd,EAIyB,SAJzB,CAAlC;AAMA,kBAAiB,UAAjB,GAA8B,GAAG,KAAH,CAAS,OAAT,GAAmB,KAAnB,CAAyB,iBAAiB,cAAjB,CAAvD;;AAEA,KAAG,CAAC,iBAAiB,SAAjB,EAA4B;AAC9B,OAAI,MAAM,OAAO,QAAP,CAAgB,IAAhB,CAAqB,KAArB,CAA2B,GAA3B,EAAgC,CAAhC,CAAN;OACA,YAAY,IAAI,WAAJ,CAAgB,GAAhB,CAAZ;OACA,YAAY,aAAa,CAAC,CAAD,GAAK,IAAI,MAAJ,GAAa,SAA/B,CAHc;AAI9B,oBAAiB,SAAjB,GAA6B,IAAI,KAAJ,CAAU,CAAV,EAAa,SAAb,CAA7B,CAJ8B;EAAhC;AAMA,kBAAiB,SAAjB,GAA6B,iBAAiB,SAAjB,GAA6B,aAA7B;;AAG7B,WAAU,MAAV,CAAiB,SAAjB,EAA4B,YAAW;AACrC,UAAO,UAAS,GAAT,EAAc;AACnB,SAAI,OAAO,WAAW,GAAX,CAAP,CADe;AAEnB,SAAI,MAAM,IAAN,CAAJ,EAAiB;AACf,cAAO,GAAP,CADe;MAAjB;AAGA,YAAO,iBAAiB,YAAjB,CAA8B,KAAK,KAAL,CAAW,IAAX,CAA9B,CAAP,CALmB;IAAd,CAD8B;EAAX,CAA5B,C;;;;;;;;ACpBA,WAAU,SAAV,CAAoB,SAApB,EAA+B,CAAC,OAAD,EAAU,YAAV,EAAwB,WAAxB,EAAqC,YAArC,EAC3B,UAAS,KAAT,EAAgB,UAAhB,EAA4B,SAA5B,EAAuC,UAAvC,EAAmD;AACrD,UAAO;AACL,eAAU,GAAV;AACA,iBAAY,IAAZ;AACA,YAAO;AACL,iBAAU,GAAV;AACA,aAAM,GAAN;AACA,cAAO,GAAP;AACA,eAAQ,GAAR;MAJF;AAMA,kBAAa,gCAAb;AACA,iBAAY,CAAC,QAAD,EAAW,UAAS,MAAT,EAAiB;AACtC,WAAI,OAAO,IAAP,CADkC;AAEtC,YAAK,UAAL,GAAkB,IAAlB,CAFsC;;AAItC,YAAK,IAAL,GAAY,UAAS,UAAT,EAAqB;AAC/B,cAAK,UAAL,GAAkB,UAAlB,CAD+B;AAE/B,cAAK,MAAL,GAF+B;QAArB,CAJ0B;;AAStC,YAAK,MAAL,GAAc,YAAW;AACvB,aAAI,KAAK,UAAL,EAAiB;AACnB,sBAAW,QAAX,CAAoB,OAAO,QAAP,EAAiB,OAAO,IAAP,CAArC,CAAkD,IAAlD,CAAuD,UAAS,KAAT,EAAgB;AACrE,oBAAO,UAAP,CAAkB,eAAlB,EAAmC,KAAnC,EAA0C,OAAO,KAAP,CAA1C,CADqE;YAAhB,CAAvD,CADmB;UAArB;QADY,CATwB;;AAiBtC,YAAK,SAAL,GAAiB,UAAS,QAAT,EAAmB;AAClC,gBAAO,OAAO,GAAP,CAAW,eAAX,EAA4B,QAA5B,CAAP,CADkC;QAAnB,CAjBqB;;AAqBtC,YAAK,QAAL,GAAgB,YAAW;AACzB,gBAAO,OAAO,KAAP,CADkB;QAAX,CArBsB;;AAyBtC,YAAK,UAAL,GAAkB,YAAW;AAC3B,gBAAO,OAAO,KAAP,CAAa,KAAb,IAAsB,MAAtB,CADoB;QAAX,CAzBoB;;AA6BtC,YAAK,QAAL,GAAgB,UAAS,CAAT,EAAY;AAC1B,gBAAO,KAAP,GAAe,CAAf,CAD0B;AAE1B,cAAK,MAAL,GAF0B;AAG1B,gBAAO,MAAP,CAAc,CAAd,EAH0B;QAAZ,CA7BsB;;AAmCtC,YAAK,SAAL,GAAiB,UAAS,QAAT,EAAmB;AAClC,gBAAO,WAAW,MAAX,CAAkB,OAAO,QAAP,EAAiB,OAAO,IAAP,EAAa,QAAhD,CAAP,CADkC;QAAnB,CAnCqB;;AAuCtC,YAAK,mBAAL,GAA2B,UAAS,SAAT,EAAoB;AAC7C,gBAAO,WAAW,mBAAX,CAA+B,OAAO,QAAP,EAAiB,OAAO,IAAP,EAAa,SAA7D,CAAP,CAD6C;QAApB,CAvCW;;AA2CtC,YAAK,IAAL,GAAY,UAAS,OAAT,EAAkB,MAAlB,EAA0B;AACpC,aAAI,KAAK,UAAL,EAAJ,EAAuB;AACnB,kBAAO;AACL,oBAAO,SAAS,eAAT,CAAyB,WAAzB;AACP,qBAAQ,SAAS,eAAT,CAAyB,YAAzB;YAFV,CADmB;UAAvB;AAMA,gBAAO;AACL,kBAAO,QAAQ,WAAR;AACP,mBAAQ,OAAO,QAAQ,WAAR,EAAqB,QAAQ,YAAR,CAApC;UAFF,CAPoC;QAA1B,CA3C0B;;AAwDtC,YAAK,QAAL,GAAgB,YAAW;AACzB,aAAI,QAAQ,EAAR;aACA,QAAQ,OAAO,KAAP,CAAa,KAAb,IAAsB,EAAtB;aACR,QAAQ,QAAQ,MAAM,KAAN,CAAY,GAAZ,CAAR,CAAR,CAHqB;AAIzB,cAAK,IAAI,CAAJ,IAAS,KAAd,EAAqB;AACnB,eAAI,QAAQ,MAAM,CAAN,EAAS,KAAT,CAAe,GAAf,CAAR;eACA,OAAO,EAAP,CAFe;AAGnB,gBAAK,GAAL,GAAW,MAAM,CAAN,CAAX,CAHmB;AAInB,gBAAK,SAAL,GAAiB,MAAM,CAAN,KAAY,IAAZ,CAJE;AAKnB,eAAI,KAAK,GAAL,CAAS,MAAT,EAAiB;AACjB,mBAAM,IAAN,CAAW,IAAX,EADiB;YAArB;UALF;AASA,gBAAO,KAAP,CAbyB;QAAX,CAxDsB;;AAwEtC,YAAK,OAAL,GAAe,UAAS,GAAT,EAAc;AAC3B,aAAI,QAAQ,KAAK,QAAL,EAAR,CADuB;AAE3B,cAAK,IAAI,CAAJ,IAAS,KAAd,EAAqB;AACnB,eAAI,MAAM,CAAN,EAAS,GAAT,IAAgB,GAAhB,EAAqB;AACvB,oBAAO,MAAM,CAAN,CAAP,CADuB;YAAzB;UADF;AAKA,gBAAO,EAAC,KAAK,GAAL,EAAR,CAP2B;QAAd,CAxEuB;;AAkFtC,YAAK,QAAL,GAAgB,UAAS,GAAT,EAAc,SAAd,EAAyB;AACvC,aAAI,QAAQ,KAAK,QAAL,GAAgB,MAAhB,CAAuB,UAAS,CAAT,EAAY;AAC7C,kBAAO,EAAE,GAAF,IAAS,GAAT,CADsC;UAAZ,CAA/B,CADmC;AAIvC,eAAM,OAAN,CAAc,EAAC,KAAK,GAAL,EAAU,WAAW,SAAX,EAAzB,EAJuC;AAKvC,gBAAO,KAAP,CAAa,KAAb,GAAqB,KAAK,UAAL,CAAgB,KAAhB,CAArB,CALuC;AAMvC,cAAK,QAAL,CAAc,OAAO,KAAP,CAAd,CANuC;QAAzB,CAlFsB;;AA2FtC,YAAK,WAAL,GAAmB,UAAS,GAAT,EAAc;AAC/B,aAAI,QAAQ,KAAK,QAAL,GAAgB,MAAhB,CAAuB,UAAS,CAAT,EAAY;AAC7C,kBAAO,EAAE,GAAF,IAAS,GAAT,CADsC;UAAZ,CAA/B,CAD2B;AAI/B,gBAAO,KAAK,UAAL,CAAgB,KAAhB,CAAP,CAJ+B;QAAd,CA3FmB;;AAkGtC,YAAK,UAAL,GAAkB,UAAS,KAAT,EAAgB;AAChC,aAAI,QAAQ,EAAR,CAD4B;AAEhC,iBAAQ,QAAQ,KAAR,CAAR,CAFgC;AAGhC,cAAK,IAAI,CAAJ,IAAS,KAAd,EAAqB;AACnB,eAAI,IAAI,MAAM,CAAN,CAAJ,CADe;AAEnB,eAAI,QAAQ,QAAR,CAAiB,CAAjB,KAAuB,EAAE,GAAF,CAAM,MAAN,EAAc;AACvC,eAAE,SAAF,GAAc,EAAE,SAAF,IAAe,KAAf,CADyB;AAEvC,iBAAI,EAAE,GAAF,GAAQ,GAAR,GAAc,EAAE,SAAF,CAFqB;AAGvC,mBAAM,IAAN,CAAW,CAAX,EAHuC;YAAzC;UAFF;AAQA,gBAAO,MAAM,IAAN,CAAW,GAAX,CAAP,CAXgC;QAAhB,CAlGoB;;AAgHtC,YAAK,QAAL,GAAgB,YAAW;AACzB,aAAI,IAAI;AACN,sBAAW,EAAX;AACA,uBAAY,EAAZ;AACA,gBAAK,OAAO,KAAP,CAAa,GAAb,IAAoB,EAApB;AACL,iBAAM,OAAO,KAAP,CAAa,IAAb,IAAqB,CAArB;AACN,qBAAU,OAAO,KAAP,CAAa,QAAb,IAAyB,EAAzB;AACV,kBAAO,KAAK,QAAL,EAAP;UANE,CADqB;AASzB,gBAAO,CAAP,CATyB;QAAX,CAhHsB;;AA4HtC,YAAK,WAAL,GAAmB,UAAS,CAAT,EAAY;AAC7B,WAAE,KAAF,GAAU,KAAK,UAAL,CAAgB,EAAE,KAAF,CAA1B;;;AAD6B,cAIxB,IAAI,CAAJ,IAAS,CAAd,EAAiB;AACf,eAAI,QAAQ,OAAR,CAAgB,EAAE,CAAF,CAAhB,CAAJ,EAA2B;AACzB,iBAAI,CAAC,OAAD,EAAU,QAAV,EAAoB,OAApB,CAA4B,CAA5B,KAAkC,CAAC,CAAD,EAAI;AACxC,iBAAE,CAAF,IAAO,EAAE,CAAF,EAAK,IAAL,CAAU,GAAV,CAAP,CADwC;cAA1C,MAEO;AACL,iBAAE,CAAF,IAAO,EAAE,CAAF,EAAK,IAAL,CAAU,GAAV,CAAP,CADK;cAFP;YADF;AAOA,aAAE,CAAF,IAAO,EAAE,CAAF,IAAO,EAAP,CARQ;AASf,eAAI,CAAC,EAAE,CAAF,EAAK,MAAL,EAAa;AAChB,oBAAO,EAAE,CAAF,CAAP,CADgB;YAAlB;UATF;AAaA,gBAAO,EAAC,QAAQ,CAAR,EAAR,CAjB6B;QAAZ,CA5HmB;MAAjB,CAAvB;IAVF,CADqD;EAAnD,CADJ,E;;;;;;;;ACAA,WAAU,SAAV,CAAoB,cAApB,EAAoC,CAAC,YAAD,EAAe,OAAf,EAAwB,UAAS,UAAT,EAAqB,KAArB,EAA4B;AACtF,UAAO;AACL,eAAU,IAAV;AACA,cAAS,UAAT;AACA,YAAO;AACL,kBAAW,GAAX;MADF;AAGA,kBAAa,8BAAb;AACA,WAAM,cAAS,KAAT,EAAgB,OAAhB,EAAyB,KAAzB,EAAgC,WAAhC,EAA6C;AACjD,aAAM,WAAN,GAAoB,KAApB,CADiD;AAEjD,aAAM,aAAN,GAAsB,KAAtB,CAFiD;AAGjD,aAAM,MAAN,GAAe,CAAf,CAHiD;;AAKjD,WAAI,WAAW,SAAX,QAAW,CAAS,KAAT,EAAgB;AAC7B,aAAI,QAAQ,EAAR,CADyB;AAE7B,cAAK,IAAI,GAAJ,IAAW,MAAM,IAAN,EAAY;AAC1B,eAAI,UAAU,MAAM,IAAN,CAAW,GAAX,CAAV,CADsB;AAE1B,iBAAM,GAAN,IAAa,QAAQ,KAAR,IAAiB,QAAQ,IAAR,IAAgB,GAAjC,CAFa;UAA5B;AAIA,gBAAO,KAAP,CAN6B;QAAhB,CALkC;;AAcjD,WAAI,kBAAkB,SAAlB,eAAkB,CAAS,KAAT,EAAgB,QAAhB,EAA0B,QAA1B,EAAoC,KAApC,EAA2C;AAC/D,aAAI,UAAU,CAAC,CAAC,QAAD,CAAD,CAAV;aAAwB,SAAS,EAAC,UAAU,CAAV,EAAV,CADmC;AAE/D,cAAK,IAAI,CAAJ,IAAS,KAAd,EAAqB;AACnB,eAAI,OAAO,MAAM,CAAN,CAAP;eACA,QAAQ,WAAW,KAAK,QAAL,CAAX,GAA4B,KAA5B,CAFO;AAGnB,eAAI,CAAC,OAAO,KAAP,CAAD,EAAgB;AAClB,oBAAO,KAAP,IAAgB,QAAQ,IAAR,CAAa,CAAC,KAAD,CAAb,IAAwB,CAAxB,CADE;YAApB;AAGA,eAAI,QAAQ,CAAR,EAAW,OAAX,CAAmB,KAAK,QAAL,CAAnB,IAAqC,CAArC,EAAwC;AAC1C,qBAAQ,CAAR,EAAW,IAAX,CAAgB,KAAK,QAAL,CAAhB,EAD0C;YAA5C;AAGA,eAAI,QAAQ,QAAQ,CAAR,EAAW,OAAX,CAAmB,KAAK,QAAL,CAAnB,CAAR,CATe;AAUnB,mBAAQ,OAAO,KAAP,CAAR,EAAuB,KAAvB,IAAgC,KAAK,KAAL,CAAhC,CAVmB;UAArB;AAYA,aAAI,YAAY,KAAK,GAAL,CAAS,KAAT,CAAe,IAAf,EAAqB,QAAQ,GAAR,CAAY,UAAS,CAAT,EAAY;AAC3D,kBAAO,EAAE,MAAF,CADoD;UAAZ,CAAjC,CAAZ,CAd2D;AAiB/D,cAAK,IAAI,IAAI,CAAJ,EAAO,IAAI,SAAJ,EAAe,GAA/B,EAAoC;AAClC,gBAAK,IAAI,CAAJ,IAAS,OAAd,EAAuB;AACrB,qBAAQ,CAAR,EAAW,CAAX,IAAgB,QAAQ,CAAR,EAAW,CAAX,KAAiB,CAAjB,CADK;YAAvB;UADF;AAKA,gBAAO,OAAP,CAtB+D;QAA3C,CAd2B;;AAuCjD,WAAI,QAAQ,SAAR,KAAQ,CAAS,KAAT,EAAgB,KAAhB,EAAuB;AACjC,aAAI,WAAW,QAAQ,MAAM,QAAN,CAAR,CAAwB,CAAxB,CAAX;aACA,WAAW,QAAQ,MAAM,QAAN,CAAR,CAAwB,CAAxB,CAAX;aACA,QAAQ,QAAQ,MAAM,KAAN,CAAR,CAAqB,CAArB,CAAR,CAH6B;;AAKjC,aAAI,CAAC,KAAD,IAAU,CAAC,QAAD,EAAW,OAAzB;;AAEA,aAAI,IAAI,YAAY,QAAZ,EAAJ,CAP6B;AAQjC,WAAE,UAAF,GAAe,CAAC,KAAD,CAAf,CARiC;AASjC,WAAE,SAAF,GAAc,CAAC,QAAD,CAAd,CATiC;AAUjC,aAAI,QAAJ,EAAc;AACZ,aAAE,SAAF,CAAY,IAAZ,CAAiB,QAAjB,EADY;UAAd;;AAIA,aAAI,QAAQ,EAAR,CAd6B;AAejC,cAAK,IAAI,CAAJ,IAAS,EAAE,KAAF,EAAS;AACrB,eAAI,IAAI,EAAE,KAAF,CAAQ,CAAR,CAAJ,CADiB;AAErB,eAAI,CAAC,KAAD,EAAQ,QAAR,EAAkB,OAAlB,CAA0B,EAAE,GAAF,CAA1B,IAAoC,CAAC,CAAD,EAAI;AAC1C,mBAAM,IAAN,CAAW,CAAX,EAD0C;YAA5C;UAFF;AAMA,aAAI,CAAC,MAAM,MAAN,EAAc;AACjB,mBAAQ,CAAC,EAAC,KAAK,KAAL,EAAY,WAAW,MAAX,EAAd,CAAR,CADiB;UAAnB;AAGA,aAAI,YAAY,MAAM,CAAN,CAAZ,IAAwB,MAAM,CAAN,EAAS,GAAT,IAAgB,QAAhB,EAA0B;AACpD,iBAAM,OAAN,CAAc,EAAC,KAAK,QAAL,EAAe,WAAW,KAAX,EAA9B,EADoD;UAAtD;;AAIA,WAAE,KAAF,GAAU,KAAV,CA5BiC;AA6BjC,WAAE,IAAF,GAAS,CAAT,CA7BiC;AA8BjC,WAAE,QAAF,GAAa,KAAb,CA9BiC;;AAgCjC,aAAI,MAAM,MAAM,GAAN,CAAU,YAAY,SAAZ,CAAsB,WAAtB,CAAV,EACU,YAAY,WAAZ,CAAwB,CAAxB,CADV,CAAN,CAhC6B;AAkCjC,aAAI,IAAJ,CAAS,UAAS,GAAT,EAAc;AACrB,uBAAY,IAAI,IAAJ,EAAU,CAAtB,EAAyB,KAAzB,EAAgC,KAAhC,EAAuC,QAAvC,EAAiD,QAAjD,EAA2D,KAA3D,EADqB;UAAd,CAAT,CAlCiC;QAAvB,CAvCqC;;AA8EjD,WAAI,cAAc,SAAd,WAAc,CAAS,IAAT,EAAe,CAAf,EAAkB,KAAlB,EAAyB,KAAzB,EAAgC,QAAhC,EAA0C,QAA1C,EAAoD,KAApD,EAA2D;AAC3E,aAAI,UAAU,QAAQ,gBAAR,CAAyB,gBAAzB,EAA2C,CAA3C,CAAV;aACA,OAAO,YAAY,IAAZ,CAAiB,OAAjB,EAA0B,UAAS,CAAT,EAAY;AAC3C,kBAAO,IAAI,GAAJ,CADoC;UAAZ,CAAjC;aAGA,SAAS,iBAAiB,UAAjB,CAA4B,IAA5B,EAAT;aACA,UAAU,gBAAgB,KAAK,KAAL,EAAY,QAA5B,EAAsC,QAAtC,EAAgD,KAAhD,CAAV;aACA,QAAQ,SAAS,KAAT,CAAR;aACA,SAAS,EAAT;aAAa,QAAQ,EAAR;aACb,YAAY,MAAM,SAAN,CAT2D;;AAW3E,aAAI,YAAY,aAAa,MAAb,EAAqB;AACnC,uBAAY,MAAZ,CADmC;UAArC;;AAIA,cAAK,IAAI,CAAJ,IAAS,OAAd,EAAuB;AACrB,eAAI,IAAI,CAAJ,EAAO;AACT,iBAAI,QAAJ,EAAc;AACZ,qBAAM,WAAN,CADY;AAEZ,qBAAM,GAAN,IAAa,QAAQ,CAAR,EAAW,CAAX,CAAb,CAFY;AAGZ,uBAAQ,CAAR,EAAW,CAAX,IAAgB,GAAhB,CAHY;AAIZ,sBAAO,IAAP,CAAY,GAAZ,EAJY;cAAd,MAKO;AACL,sBAAO,IAAP,CAAY,QAAQ,CAAR,EAAW,CAAX,CAAZ,EADK;cALP;AAQA,mBAAM,QAAQ,CAAR,EAAW,CAAX,CAAN,IAAuB,SAAvB,CATS;YAAX;UADF;;AAcA,YAAG,MAAH,CAAU,OAAV,EACG,KADH,CACS,OADT,EACkB,KAAK,KAAL,GAAa,IAAb,CADlB,CAEG,KAFH,CAES,QAFT,EAEmB,KAAK,MAAL,GAAc,IAAd,CAFnB,CA7B2E;;AAiC3E,aAAI,QAAQ,GAAG,QAAH,CAAY;AACtB,mBAAQ,OAAR;AACA,iBAAM;AACF,sBAAS,OAAT;AACA,oBAAO,KAAP;AACA,oBAAO,eAAS,MAAT,EAAgB,CAAhB,EAAmB;AACxB,mBAAI,IAAI,EAAE,EAAF,IAAQ,CAAR,CADgB;AAExB,mBAAI,aAAa,KAAb,IAAsB,CAAC,QAAD,EAAW;AACnC,qBAAI,EAAE,KAAF,CAD+B;gBAArC,CAFwB;AAKxB,sBAAO,OAAO,CAAP,CAAP,CALwB;cAAnB;AAOP,oBAAO,IAAP;AACA,gBAAG,QAAH;AACA,qBAAQ,CAAC,MAAD,CAAR;AACA,oBAAO,KAAP;YAbJ;AAeA,kBAAO;AACL,mBAAM,KAAN;YADF;AAGA,iBAAM;AACJ,oBAAO;AACL,qBAAM,KAAN;cADF;YADF;AAKA,iBAAM;AACF,gBAAG;AACC,qBAAM,UAAN;AACA,qBAAM;AACJ,0BAAS,IAAT;AACA,sBAAK,IAAL;gBAFF;cAFJ;AAOA,gBAAI;AACD,qBAAM;AACF,yBAAQ,iBAAiB,YAAjB;AACR,0BAAS,IAAT;AACA,sBAAK,IAAL;gBAHJ;AAKA,sBAAO,CAAC,EAAC,OAAM,CAAN,EAAF,CAAP;cANH;YARJ;UAzBU,CAAR,CAjCuE;;AA6E3E,eAAM,WAAN,GAAoB,IAApB,CA7E2E;AA8E3E,eAAM,aAAN,GAAsB,KAAK,gBAAL,GAAwB,EAAE,QAAF,CA9E6B;AA+E3E,eAAM,MAAN,GAAe,EAAE,QAAF,CA/E4D;QAA3D,CA9E+B;;AAgKjD,WAAI,cAAc,YAAY,SAAZ,CAAsB,UAAS,KAAT,EAAgB,KAAhB,EAAuB,KAAvB,EAA8B;AACpE,eAAM,KAAN,EAAa,KAAb,EADoE;QAA9B,CAApC,CAhK6C;AAmKjD,aAAM,GAAN,CAAU,UAAV,EAAsB,WAAtB,EAnKiD;;AAqKjD,WAAI,aAAa;AACf,gBAAO;AACL,kBAAO,OAAP;AACA,qBAAU,YAAV;AACA,kBAAO,CAAC,YAAD,CAAP;AACA,qBAAU,EAAV;AACA,mBAAQ,CAAR;AACA,qBAAU,KAAV;UANF;AAQA,mBAAU;AACR,kBAAO,gBAAP;AACA,qBAAU,QAAV;AACA,kBAAO,CAAC,YAAD,CAAP;AACA,qBAAU,EAAV;AACA,mBAAQ,CAAR;AACA,mBAAQ,IAAR;AACA,qBAAU,KAAV;UAPF;QATE,CArK6C;;AAyLjD,WAAI,MAAM,SAAN,IAAmB,MAAnB,EAA2B;AAC7B,oBAAW,QAAX,GAAsB;AACpB,kBAAO,QAAP;AACA,qBAAU,YAAV;AACA,kBAAO,CAAC,YAAD,CAAP;AACA,qBAAU,EAAV;AACA,mBAAQ,CAAR;AACA,qBAAU,KAAV;UANF,CAD6B;QAA/B;;AAWA,WAAI,MAAM,SAAN,IAAmB,KAAnB,EAA0B;AAC5B,oBAAW,QAAX,GAAsB;AACpB,kBAAO,YAAP;AACA,qBAAU,UAAV;AACA,kBAAO,CAAC,YAAD,CAAP;AACA,qBAAU,EAAV;AACA,mBAAQ,CAAR;AACA,qBAAU,KAAV;UANF,CAD4B;QAA9B;;AAWA,mBAAY,IAAZ,CAAiB,UAAjB,EA/MiD;MAA7C;IAPR,CADsF;EAA5B,CAA5D,E;;;;;;;;ACDA,KAAI,UAAU,MAAV;KACA,UAAU,MAAV;;AAEJ,WAAU,SAAV,CAAoB,iBAApB,EAAuC,CAAC,YAAD,EAAe,OAAf,EAAwB,UAAS,UAAT,EAAqB,KAArB,EAA4B;AACzF,UAAO;AACP,eAAU,IAAV;AACA,cAAS,UAAT;AACA,YAAO;AACL,kBAAW,GAAX;MADF;AAGA,kBAAa,iCAAb;AACA,WAAM,cAAS,KAAT,EAAgB,OAAhB,EAAyB,KAAzB,EAAgC,WAAhC,EAA6C;AACjD,aAAM,WAAN,GAAoB,KAApB,CADiD;AAEjD,aAAM,OAAN,GAAgB,EAAhB,CAFiD;AAGjD,aAAM,IAAN,GAAa,EAAb,CAHiD;AAIjD,aAAM,KAAN,GAAc,EAAd,CAJiD;;AAMjD,WAAI,QAAQ,SAAR,KAAQ,CAAS,KAAT,EAAgB,KAAhB,EAAuB;AACjC,eAAM,IAAN,GAAa,QAAQ,MAAM,IAAN,CAArB,CADiC;AAEjC,eAAM,OAAN,GAAgB,QAAQ,MAAM,OAAN,CAAxB,CAFiC;AAGjC,eAAM,UAAN,GAAmB,QAAQ,MAAM,UAAN,CAA3B;;;;AAHiC,aAO7B,IAAI,YAAY,QAAZ,EAAJ,CAP6B;AAQjC,WAAE,UAAF,GAAe,EAAE,UAAF,CAAa,MAAb,CAAoB,MAAM,UAAN,CAAnC,CARiC;AASjC,aAAI,CAAC,EAAE,UAAF,CAAa,MAAb,EAAqB;AACxB,aAAE,UAAF,GAAe,kBAAkB,KAAlB,CAAf,CADwB;UAA1B;AAGA,WAAE,SAAF,GAAc,EAAE,SAAF,CAAY,MAAZ,CAAmB,MAAM,IAAN,CAAjC,CAZiC;AAajC,WAAE,SAAF,GAAc,EAAE,SAAF,CAAY,MAAZ,CAAmB,MAAM,OAAN,CAAjC,CAbiC;AAcjC,WAAE,IAAF,GAAS,CAAT,CAdiC;AAejC,WAAE,QAAF,GAAa,EAAE,QAAF,GAAa,KAAb,CAfoB;;AAiBjC,WAAE,KAAF,GAAU,QAAQ,EAAE,KAAF,CAAlB,CAjBiC;AAkBjC,aAAI,aAAa,MAAM,IAAN,CAAW,MAAX,CAAkB,MAAM,OAAN,CAA/B;aACA,OAAO,WAAW,MAAX,CAAkB,EAAE,UAAF,CAAzB,CAnB6B;AAoBjC,cAAK,IAAI,CAAJ,IAAS,UAAd,EAA0B;AACxB,eAAI,KAAK,WAAW,CAAX,CAAL,CADoB;AAExB,eAAI,CAAC,YAAY,OAAZ,CAAoB,EAApB,EAAwB,SAAxB,EAAmC;AACtC,iBAAI,EAAE,KAAF,CAAQ,OAAR,CAAgB,EAAhB,KAAuB,CAAC,CAAD,EAAI;AAC7B,iBAAE,KAAF,CAAQ,IAAR,CAAa,EAAC,KAAK,EAAL,EAAd,EAD6B;cAA/B;YADF;UAFF;AAQA,aAAI,QAAQ,EAAR,CA5B6B;AA6BjC,cAAK,IAAI,CAAJ,IAAS,EAAE,KAAF,EAAS;AACrB,eAAI,IAAI,EAAE,KAAF,CAAQ,CAAR,CAAJ,CADiB;AAErB,eAAI,KAAK,OAAL,CAAa,EAAE,GAAF,CAAb,IAAuB,CAAC,CAAD,EAAI;AAC7B,mBAAM,IAAN,CAAW,CAAX,EAD6B;YAA/B;UAFF;AAMA,WAAE,KAAF,GAAU,KAAV,CAnCiC;;AAqCjC,aAAI,MAAM,MAAM,GAAN,CAAU,YAAY,SAAZ,CAAsB,WAAtB,CAAV,EACU,YAAY,WAAZ,CAAwB,CAAxB,CADV,CAAN,CArC6B;AAuCjC,aAAI,IAAJ,CAAS,UAAS,GAAT,EAAc;AACrB,uBAAY,IAAI,IAAJ,EAAU,CAAtB,EAAyB,KAAzB,EAAgC,KAAhC,EADqB;UAAd,CAAT,CAvCiC;QAAvB,CANqC;;AAkDjD,WAAI,cAAc,SAAd,WAAc,CAAS,IAAT,EAAe,CAAf,EAAkB,KAAlB,EAAyB,KAAzB,EAAgC;AAChD,eAAM,IAAN,GAAa,QAAQ,MAAM,IAAN,CAArB,CADgD;AAEhD,eAAM,OAAN,GAAgB,QAAQ,MAAM,OAAN,CAAxB,CAFgD;;AAIhD,aAAI,aAAa,KAAK,UAAL,CAAgB,GAAhB,CAAoB,UAAS,GAAT,EAAc;AACjD,kBAAO,MAAM,UAAN,CAAiB,GAAjB,CAAP,CADiD;UAAd,CAAjC;;;;AAJ4C,aAU5C,SAAS,EAAT;aAAa,QAAQ,EAAR;aACb,cAAc,EAAd;aAAkB,iBAAiB,EAAjB;aAClB,WAAW,EAAX;aAAe,cAAc,EAAd,CAZ6B;;AAchD,cAAK,IAAI,CAAJ,IAAS,KAAK,KAAL,EAAY;AACxB,eAAI,YAAY,SAAZ,SAAY,CAAS,CAAT,EAAY;AAAE,oBAAO,KAAK,CAAL,CAAP,CAAF;YAAZ;eACZ,WAAW,SAAX,QAAW,CAAS,CAAT,EAAY;AAAE,oBAAO,KAAK,MAAM,OAAN,CAAc,CAAd,CAAL,IAAyB,KAAK,CAAL,CAAzB,CAAT;YAAZ,CAFS;;AAIxB,eAAI,OAAO,KAAK,KAAL,CAAW,CAAX,CAAP;eACA,aAAa,MAAM,IAAN,CAAW,GAAX,CAAe,SAAf,CAAb;eACA,UAAU,MAAM,IAAN,CAAW,GAAX,CAAe,QAAf,EAAyB,IAAzB,CAA8B,OAA9B,CAAV;eACA,oBAAoB,MAAM,OAAN,CAAc,GAAd,CAAkB,SAAlB,CAApB;eACA,iBAAiB,MAAM,OAAN,CAAc,GAAd,CAAkB,QAAlB,CAAjB,CARoB;;AAUxB,gBAAK,IAAI,CAAJ,IAAS,UAAd,EAA0B;AACxB,iBAAI,MAAM,WAAW,CAAX,CAAN;iBACA,QAAQ,IAAI,KAAJ,IAAa,IAAI,IAAJ;iBACrB,gBAAgB,kBAAkB,MAAlB,CAAyB,CAAC,KAAD,CAAzB,CAAhB,CAHoB;AAIpB,0BAAa,eAAe,MAAf,CAAsB,CAAC,KAAD,CAAtB,EAA+B,IAA/B,CAAoC,OAApC,CAAb,CAJoB;;AAMxB,iBAAI,SAAS,OAAT,CAAiB,OAAjB,KAA6B,CAAC,CAAD,EAAI;AACnC,wBAAS,IAAT,CAAc,OAAd,EADmC;AAEnC,0BAAW,GAAX,GAAiB,OAAjB,CAFmC;AAGnC,2BAAY,IAAZ,CAAiB,UAAjB,EAHmC;cAArC;;AAMA,iBAAI,YAAY,OAAZ,CAAoB,UAApB,KAAmC,CAAC,CAAD,EAAI;AACzC,2BAAY,IAAZ,CAAiB,UAAjB,EADyC;AAEzC,8BAAe,IAAf,CAAoB,aAApB,EAFyC;cAA3C;;AAKA,iBAAI,MAAM,CAAC,OAAD,EAAU,UAAV,EAAsB,IAAtB,CAA2B,OAA3B,CAAN,CAjBoB;AAkBxB,oBAAO,GAAP,IAAc,KAAK,IAAI,GAAJ,CAAnB,CAlBwB;YAA1B;UAVF;;AAgCA,cAAK,IAAI,CAAJ,IAAS,QAAd,EAAwB;AACtB,eAAI,UAAU,SAAS,CAAT,CAAV,CADkB;AAEtB,eAAI,MAAM,EAAN,CAFkB;AAGtB,gBAAK,IAAI,CAAJ,IAAS,WAAd,EAA2B;AACzB,iBAAI,aAAa,YAAY,CAAZ,CAAb,CADqB;AAEzB,iBAAI,MAAM,CAAC,OAAD,EAAU,UAAV,EAAsB,IAAtB,CAA2B,OAA3B,CAAN,CAFqB;AAGzB,iBAAI,IAAJ,CAAS,OAAO,GAAP,KAAe,KAAK,UAAL,CAAgB,GAAhB,CAAoB,UAAS,CAAT,EAAY;AAAE,sBAAO,SAAP,CAAF;cAAZ,CAAnC,CAAT,CAHyB;YAA3B;AAKA,iBAAM,IAAN,CAAW,GAAX,EARsB;UAAxB;;AAWA,eAAM,IAAN,GAAa,WAAb,CAzDgD;AA0DhD,eAAM,OAAN,GAAgB,cAAhB,CA1DgD;AA2DhD,eAAM,KAAN,GAAc,KAAd,CA3DgD;AA4DhD,eAAM,WAAN,GAAoB,IAApB,CA5DgD;QAAhC,CAlD+B;;AAkHjD,WAAI,cAAc,YAAY,SAAZ,CAAsB,UAAS,KAAT,EAAgB,KAAhB,EAAuB,KAAvB,EAA8B;AACpE,eAAM,KAAN,EAAa,KAAb,EADoE;QAA9B,CAApC,CAlH6C;AAqHjD,aAAM,GAAN,CAAU,UAAV,EAAsB,WAAtB,EArHiD;;AAuHjD,WAAI,oBAAoB,SAApB,iBAAoB,CAAS,KAAT,EAAgB;AACtC,aAAI,OAAO,EAAP,CADkC;AAEtC,cAAK,IAAI,CAAJ,IAAS,MAAM,UAAN,EAAkB;AAC9B,eAAI,MAAM,MAAM,UAAN,CAAiB,CAAjB,CAAN,CAD0B;AAE9B,gBAAK,IAAL,CAAU,IAAI,GAAJ,CAAV,CAF8B;UAAhC;AAIA,gBAAO,IAAP,CANsC;QAAhB;;;AAvHyB,kBAiIjD,CAAY,IAAZ,CAAiB;AACf,kBAAS;AACP,kBAAO,SAAP;AACA,qBAAU,YAAV;AACA,kBAAO,CAAC,YAAD,CAAP;AACA,qBAAU,EAAV;AACA,mBAAQ,CAAR;AACA,qBAAU,IAAV;UANF;AAQA,eAAM;AACJ,kBAAO,MAAP;AACA,qBAAU,SAAV;AACA,kBAAO,CAAC,YAAD,CAAP;AACA,qBAAU,EAAV;AACA,mBAAQ,CAAR;AACA,qBAAU,IAAV;UANF;AAQA,qBAAY;AACV,kBAAO,QAAP;AACA,qBAAU,WAAV;AACA,kBAAO,CAAC,YAAD,CAAP;AACA,qBAAU,iBAAV;AACA,mBAAQ,CAAR;AACA,qBAAU,IAAV;UANF;;QAjBF,EAjIiD;MAA7C;IAPN,CADyF;EAA5B,CAA/D,E;;;;;;;;ACFA,WAAU,SAAV,CAAoB,cAApB,EAAoC,CAAC,YAAD,EAAe,OAAf,EAAwB,IAAxB,EAA8B,UAAS,UAAT,EAAqB,KAArB,EAA4B,EAA5B,EAAgC;AAChG,UAAO;AACP,eAAU,IAAV;AACA,cAAS,UAAT;AACA,YAAO;AACL,kBAAW,GAAX;MADF;AAGA,kBAAa,8BAAb;AACA,WAAM,cAAS,KAAT,EAAgB,OAAhB,EAAyB,KAAzB,EAAgC,WAAhC,EAA6C;AACjD,aAAM,IAAN,GAAa,CAAb,CADiD;AAEjD,aAAM,IAAN,GAAa,EAAb,CAFiD;AAGjD,aAAM,OAAN,GAAgB,EAAhB,CAHiD;AAIjD,aAAM,QAAN,GAAiB,EAAjB,CAJiD;AAKjD,aAAM,OAAN,GAAgB,YAAY,OAAZ,CALiC;AAMjD,aAAM,QAAN,GAAiB,YAAY,QAAZ,CANgC;;AAQjD,WAAI,QAAQ,SAAR,KAAQ,CAAS,KAAT,EAAgB,KAAhB,EAAuB;AACjC,aAAI,IAAI,YAAY,QAAZ,EAAJ,CAD6B;AAEjC,WAAE,MAAF,GAAW,QAAQ,MAAM,MAAN,CAAnB,CAFiC;AAGjC,aAAI,EAAE,MAAF,CAAS,MAAT,IAAmB,CAAnB,EAAsB;AACxB,aAAE,MAAF,GAAW,cAAc,KAAd,CAAX,CADwB;UAA1B;;AAIA,aAAI,QAAQ,EAAR,CAP6B;AAQjC,cAAK,IAAI,CAAJ,IAAS,EAAE,KAAF,EAAS;AACrB,eAAI,IAAI,EAAE,KAAF,CAAQ,CAAR,CAAJ,CADiB;AAErB,eAAI,EAAE,MAAF,CAAS,OAAT,CAAiB,EAAE,GAAF,CAAjB,IAA2B,CAAC,CAAD,EAAI;AACjC,mBAAM,IAAN,CAAW,CAAX,EADiC;YAAnC;UAFF;AAMA,WAAE,KAAF,GAAU,KAAV,CAdiC;;AAgBjC,aAAI,KAAK,QAAQ,IAAR,CAAa,CAAb,CAAL,CAhB6B;AAiBjC,YAAG,SAAH,GAAe,GAAG,MAAH,GAAY,EAAZ,CAjBkB;AAkBjC,YAAG,IAAH,GAAU,CAAV,CAlBiC;AAmBjC,aAAI,MAAM,MAAM,GAAN,CAAU,YAAY,SAAZ,CAAsB,OAAtB,CAAV,EACU,YAAY,WAAZ,CAAwB,CAAxB,CADV,CAAN,CAnB6B;AAqBjC,aAAI,IAAJ,CAAS,UAAS,GAAT,EAAc;AACrB,uBAAY,IAAI,IAAJ,EAAU,CAAtB,EAAyB,KAAzB,EAAgC,KAAhC,EADqB;UAAd,CAAT,CArBiC;QAAvB,CARqC;;AAkCjD,WAAI,cAAc,SAAd,WAAc,CAAS,IAAT,EAAe,CAAf,EAAkB,KAAlB,EAAyB,KAAzB,EAAgC;AAChD,aAAI,CAAC,KAAK,IAAL,CAAU,MAAV,EAAkB;AACrB,iBAAM,OAAN,GAAgB,EAAhB,CADqB;AAErB,iBAAM,IAAN,GAAa,EAAb,CAFqB;AAGrB,iBAAM,QAAN,GAAiB,EAAjB,CAHqB;AAIrB,kBAJqB;UAAvB,CADgD;;AAQhD,aAAI,UAAU,EAAV;aACA,OAAO,IAAP;aACA,WAAW,CAAX,CAV4C;;AAYhD,cAAK,IAAI,CAAJ,IAAS,KAAK,MAAL,EAAa;AACzB,eAAI,MAAM,KAAK,MAAL,CAAY,CAAZ,CAAN;eACA,SAAS,MAAM,IAAN,CAAW,GAAX,CAAT;eACA,SAAS,OAAO,SAAP,GAAmB,OAAO,SAAP,GAAmB,MAAtC,CAHY;;AAKzB,eAAI,QAAQ,OAAO,IAAP,IAAe,IAAf,EAAqB;AAC/B,qBAAQ,QAAR,EAAkB,IAAlB,IAA0B,CAA1B,CAD+B;AAE/B,oBAAO,IAAP,GAAc,CAAd,CAF+B;YAAjC,MAGO;AACL,oBAAO,IAAP,GAAc,CAAd,CADK;AAEL,oBAAO,KAAP,GAAe,OAAO,KAAP,IAAgB,OAAO,IAAP,CAF1B;AAGL,oBAAO,MAAP,GAAgB,OAAO,KAAP,IAAgB,OAAO,IAAP,CAH3B;AAIL,oBAAO,IAAP,GAAc,OAAO,SAAP,CAJT;AAKL,oBAAO,OAAO,IAAP,CALF;AAML,wBAAW,QAAQ,MAAR,CANN;YAHP;AAWA,mBAAQ,IAAR,CAAa,MAAb,EAhByB;UAA3B;AAkBA,eAAM,OAAN,GAAgB,OAAhB,CA9BgD;AA+BhD,eAAM,IAAN,GAAa,KAAK,IAAL,CA/BmC;AAgChD,eAAM,QAAN,GAAiB;AACf,iBAAM,EAAE,IAAF;AACN,qBAAU,EAAE,QAAF;AACV,kBAAO,KAAK,gBAAL;UAHT,CAhCgD;QAAhC,CAlC+B;;AAyEjD,WAAI,gBAAgB,SAAhB,aAAgB,CAAS,KAAT,EAAgB;AAClC,aAAI,WAAW,EAAX,CAD8B;AAElC,cAAK,IAAI,CAAJ,IAAS,MAAM,QAAN,EAAgB;AAC5B,eAAI,MAAM,MAAM,QAAN,CAAe,CAAf,CAAN,CADwB;AAE5B,oBAAS,IAAT,CAAc,IAAI,GAAJ,CAAd,CAF4B;UAA9B;AAIA,cAAK,IAAI,CAAJ,IAAS,MAAM,UAAN,EAAkB;AAC9B,eAAI,MAAM,MAAM,UAAN,CAAiB,CAAjB,CAAN,CAD0B;AAE9B,gBAAK,IAAI,CAAJ,IAAS,IAAI,UAAJ,EAAgB;AAC5B,iBAAI,OAAO,IAAI,UAAJ,CAAe,CAAf,CAAP,CADwB;AAE5B,iBAAI,KAAK,IAAI,eAAJ,EAAqB;AAC5B,wBAAS,IAAT,CAAc,KAAK,GAAL,CAAd,CAD4B;cAA9B;YAFF;UAFF;AASA,gBAAO,QAAP,CAfkC;QAAhB,CAzE6B;;AA2FjD,WAAI,cAAc,YAAY,SAAZ,CAAsB,UAAS,KAAT,EAAgB,KAAhB,EAAuB,KAAvB,EAA8B;AACpE,eAAM,KAAN,EAAa,KAAb,EADoE;QAA9B,CAApC,CA3F6C;AA8FjD,aAAM,GAAN,CAAU,UAAV,EAAsB,WAAtB;;;AA9FiD,kBAiGjD,CAAY,IAAZ,CAAiB;AACf,iBAAQ;AACN,kBAAO,SAAP;AACA,qBAAU,YAAV;AACA,kBAAO,CAAC,YAAD,EAAe,UAAf,CAAP;AACA,qBAAU,aAAV;AACA,mBAAQ,CAAR;AACA,qBAAU,IAAV;UANF;QADF,EAjGiD;MAA7C;IAPN,CADgG;EAAhC,CAAlE,E;;;;;;;;ACAA,WAAU,SAAV,CAAoB,cAApB,EAAoC,CAAC,UAAD,EAAa,WAAb,EAA0B,UAAU,QAAV,EAAoB,SAApB,EAA+B;AAC3F,UAAO;AACL,eAAU,GAAV;AACA,cAAS,UAAT;AACA,YAAO;AACL,kBAAW,GAAX;MADF;AAGA,kBAAa,8BAAb;AACA,WAAM,cAAU,KAAV,EAAiB,OAAjB,EAA0B,KAA1B,EAAiC,WAAjC,EAA8C;AAClD,aAAM,SAAN,GAAkB,KAAlB,CADkD;AAElD,aAAM,OAAN,GAAgB,KAAhB,CAFkD;AAGlD,aAAM,OAAN,GAAgB,KAAhB,CAHkD;AAIlD,aAAM,KAAN,GAAc,EAAd,CAJkD;AAKlD,aAAM,GAAN,GAAY,CAAZ,CALkD;AAMlD,aAAM,GAAN,GAAY,CAAZ,CANkD;;AAQlD,aAAM,MAAN,CAAa,SAAb,EAAwB,UAAS,CAAT,EAAY;AAClC,aAAI,CAAC,MAAM,OAAN,IAAiB,MAAM,OAAN,CAAc,KAAd,IAAuB,MAAM,OAAN,CAAc,QAAd,EAAwB;AACnE,kBADmE;UAArE;AAGA,eAAM,OAAN,GAAgB,SAAS,MAAM,OAAN,CAAc,IAAd,EAAoB,EAA7B,KAAoC,CAApC,CAJkB;AAKlC,eAAM,GAAN,GAAY,KAAK,IAAL,CAAU,MAAM,OAAN,CAAc,KAAd,GAAsB,MAAM,OAAN,CAAc,QAAd,CAA5C,CALkC;AAMlC,aAAI,QAAQ,EAAR;aACF,MAAM,MAAM,GAAN;aACN,QAAQ,CAAR;aACA,MAAM,MAAM,OAAN,GAAgB,KAAhB;aACN,OAAO,MAAM,OAAN,GAAgB,KAAhB,CAVyB;;AAYlC,aAAI,MAAM,CAAN,EAAS;AACX,iBAAM,CAAN,CADW;AAEX,kBAAO,KAAK,GAAL,CAAS,CAAC,GAAE,KAAF,GAAS,CAAV,EAAa,GAAtB,CAAP,CAFW;UAAb;AAIA,aAAI,OAAO,GAAP,EAAY;AACd,kBAAO,GAAP,CADc;AAEd,iBAAM,KAAK,GAAL,CAAS,CAAT,EAAY,MAAO,IAAE,KAAF,GAAS,CAAhB,CAAlB,CAFc;UAAhB;;AAKA,cAAK,IAAI,OAAO,GAAP,EAAY,QAAQ,IAAR,EAAc,MAAnC,EAA2C;;AAEzC,iBAAM,IAAN,CAAW;AACT,mBAAM,IAAN;AACA,sBAAS,QAAQ,MAAM,OAAN;YAFnB,EAFyC;UAA3C;;AAQA,eAAM,OAAN,GAAgB,MAAM,OAAN,GAAgB,CAAhB,CA7BkB;AA8BlC,eAAM,OAAN,GAAgB,MAAM,OAAN,GAAgB,GAAhB,CA9BkB;AA+BlC,eAAM,SAAN,GAAkB,MAAM,CAAN,CA/BgB;AAgClC,eAAM,KAAN,GAAc,KAAd,CAhCkC;QAAZ,CAAxB,CARkD;;AA2ClD,aAAM,OAAN,GAAgB,UAAS,IAAT,EAAe;AAC7B,aAAI,QAAQ,CAAR,IAAa,QAAQ,MAAM,GAAN,EAAW;AAClC,eAAI,QAAQ,YAAY,QAAZ,EAAR,CAD8B;AAElC,iBAAM,IAAN,GAAa,IAAb,CAFkC;AAGlC,uBAAY,QAAZ,CAAqB,KAArB,EAHkC;UAApC;QADc,CA3CkC;MAA9C;IAPR,CAD2F;EAA/B,CAA9D,E;;;;;;;;ACAA,WAAU,SAAV,CAAoB,cAApB,EAAoC,CAAC,YAAD,EAAe,eAAf,EAAgC,UAAS,UAAT,EAAqB,aAArB,EAAoC;AACtG,UAAO;AACL,eAAU,IAAV;AACA,cAAS,UAAT;AACA,YAAO,EAAP;AAEA,kBAAa,8BAAb;AACA,WAAM,cAAS,MAAT,EAAiB,QAAjB,EAA2B,KAA3B,EAAkC,WAAlC,EAA+C;AACnD,WAAI,QAAQ,IAAR,CAD+C;;AAGnD,cAAO,KAAP,GAAe,EAAf,CAHmD;AAInD,cAAO,IAAP,GAAc,EAAd,CAJmD;AAKnD,cAAO,gBAAP,GAA0B,EAA1B,CALmD;AAMnD,cAAO,OAAP,GAAiB,EAAjB,CANmD;AAOnD,cAAO,OAAP,GAAiB,YAAY,OAAZ,CAPkC;AAQnD,cAAO,QAAP,GAAkB,YAAY,QAAZ,CARiC;AASnD,cAAO,SAAP,GAAmB,IAAnB,CATmD;;AAWnD,WAAI,SAAS,SAAT,MAAS,GAAW;AACtB,qBAAY,QAAZ,CAAqB,OAAO,KAAP,CAArB,CADsB;QAAX,CAXsC;;AAenD,cAAO,GAAP,GAAa,UAAS,IAAT,EAAe,GAAf,EAAoB;AAC/B,aAAI,KAAK,QAAL,CAAc,OAAd,CAAsB,GAAtB,KAA8B,CAAC,CAAD,EAAI;AACpC,eAAI,KAAK,QAAL,EAAe;AACjB,kBAAK,QAAL,CAAc,IAAd,CAAmB,GAAnB,EADiB;YAAnB,MAEO;AACL,iBAAI,KAAK,QAAL,CAAc,MAAd,EAAsB;AACxB,sBAAO,KAAP,CAAa,KAAb,GAAqB,YAAY,WAAZ,CAAwB,KAAK,QAAL,CAAc,CAAd,CAAxB,CAArB,CADwB;cAA1B;AAGA,kBAAK,QAAL,GAAgB,CAAC,GAAD,CAAhB,CAJK;YAFP;AAQA,kBAAO,KAAP,CAAa,KAAK,IAAL,CAAb,GAA0B,KAAK,QAAL,CATU;AAUpC,oBAVoC;UAAtC;QADW,CAfsC;;AA8BnD,cAAO,MAAP,GAAgB,UAAS,IAAT,EAAe,GAAf,EAAoB;AAClC,aAAI,IAAI,KAAK,QAAL,CAAc,OAAd,CAAsB,GAAtB,CAAJ,CAD8B;AAElC,aAAI,KAAK,CAAC,CAAD,EAAI;AACX,gBAAK,QAAL,CAAc,MAAd,CAAqB,CAArB,EAAwB,CAAxB,EADW;AAEX,kBAAO,KAAP,CAAa,KAAK,IAAL,CAAb,GAA0B,KAAK,QAAL,CAFf;AAGX,kBAAO,KAAP,CAAa,KAAb,GAAqB,YAAY,WAAZ,CAAwB,GAAxB,CAArB,CAHW;AAIX,oBAJW;UAAb;QAFc,CA9BmC;;AAwCnD,WAAI,cAAc,SAAd,WAAc,GAAW;AAC3B,aAAI,UAAU,EAAV,CADuB;AAE3B,cAAK,IAAI,EAAJ,IAAU,MAAM,UAAN,EAAkB;AAC/B,eAAI,MAAM,MAAM,UAAN,CAAiB,EAAjB,CAAN,CAD2B;AAE/B,gBAAK,IAAI,EAAJ,IAAU,IAAI,UAAJ,EAAgB;AAC7B,iBAAI,OAAO,QAAQ,IAAR,CAAa,IAAI,UAAJ,CAAe,EAAf,CAAb,CAAP,CADyB;AAE7B,kBAAK,SAAL,GAAiB,GAAjB,CAF6B;AAG7B,kBAAK,IAAL,GAAY,YAAZ,CAH6B;AAI7B,iBAAI,cAAc,IAAI,KAAJ,CAAd,IAA4B,cAAc,KAAK,KAAL,CAA1C,EAAuD;AACzD,oBAAK,QAAL,GAAgB,KAAK,KAAK,KAAL,CADoC;cAA3D;AAGA,kBAAK,OAAL,GAAe,MAAM,IAAI,KAAJ,GAAY,KAAK,KAAL,CAPJ;AAQ7B,kBAAK,KAAL,GAAa,IAAI,KAAJ,CARgB;AAS7B,qBAAQ,IAAR,CAAa,IAAb,EAT6B;YAA/B;UAFF;;AAeA,cAAK,IAAI,EAAJ,IAAU,MAAM,UAAN,EAAkB;AAC/B,eAAI,MAAM,MAAM,UAAN,CAAiB,EAAjB,CAAN,CAD2B;AAE/B,eAAI,IAAJ,GAAW,YAAX,CAF+B;AAG/B,eAAI,OAAJ,GAAc,MAAM,EAAN,CAHiB;AAI/B,mBAAQ,IAAR,CAAa,GAAb,EAJ+B;UAAjC;;AAOA,cAAK,IAAI,EAAJ,IAAU,MAAM,QAAN,EAAgB;AAC7B,eAAI,MAAM,MAAM,QAAN,CAAe,EAAf,CAAN,CADyB;AAE7B,eAAI,IAAJ,GAAW,UAAX,CAF6B;AAG7B,eAAI,OAAJ,GAAc,MAAM,EAAN,CAHe;AAI7B,mBAAQ,IAAR,CAAa,GAAb,EAJ6B;UAA/B;;AAOA,gBAAO,OAAP,CA/B2B;QAAX,CAxCiC;;AA0EnD,WAAI,cAAc,SAAd,WAAc,CAAS,CAAT,EAAY,CAAZ,EAAe;AAC/B,gBAAO,EAAE,KAAF,CAAQ,aAAR,CAAsB,EAAE,KAAF,CAA7B,CAD+B;QAAf,CA1EiC;;AA8EnD,WAAI,WAAW,SAAX,QAAW,CAAS,KAAT,EAAgB,OAAhB,EAAyB;AACtC,aAAI,OAAO,EAAP,CADkC;AAEtC,aAAI,CAAC,YAAY,UAAZ,EAAwB,OAAO,EAAP,CAA7B;;AAEA,cAAK,IAAI,IAAJ,IAAY,YAAY,UAAZ,EAAwB;AACvC,eAAI,OAAO,YAAY,UAAZ,CAAuB,IAAvB,CAAP,CADmC;AAEvC,gBAAK,IAAL,GAAY,IAAZ,CAFuC;AAGvC,eAAI,CAAC,QAAQ,SAAR,CAAkB,KAAK,MAAL,CAAnB,EAAiC;AACnC,kBAAK,MAAL,GAAc,KAAK,QAAL,CADqB;YAArC;AAGA,gBAAK,MAAL,GAAc,KAAK,MAAL,IAAe,CAAf,CANyB;AAOvC,gBAAK,SAAL,GAAiB,EAAjB,CAPuC;AAQvC,gBAAK,MAAL,GAAc,EAAd,CARuC;;AAUvC,gBAAK,QAAL,GAAgB,QAAQ,MAAM,IAAN,CAAR,CAAhB,CAVuC;AAWvC,eAAI,CAAC,KAAK,QAAL,CAAc,MAAd,EAAsB;AACzB,iBAAI,QAAQ,UAAR,CAAmB,KAAK,QAAL,CAAvB,EAAuC;AACrC,oBAAK,QAAL,GAAgB,KAAK,QAAL,CAAc,KAAd,CAAhB,CADqC;cAAvC,MAEO;AACL,oBAAK,QAAL,GAAgB,QAAQ,KAAK,QAAL,CAAxB,CADK;cAFP;YADF;AAOA,gBAAK,SAAL,GAAiB,KAAK,SAAL,CAAe,IAAf,CAAoB,WAApB,CAAjB,CAlBuC;AAmBvC,gBAAK,MAAL,GAAc,KAAK,MAAL,CAAY,IAAZ,CAAiB,WAAjB,CAAd,CAnBuC;;AAqBvC,gBAAK,IAAI,CAAJ,IAAS,OAAd,EAAuB;AACrB,iBAAI,MAAM,QAAQ,CAAR,CAAN,CADiB;AAErB,iBAAI,KAAK,QAAL,CAAc,OAAd,CAAsB,IAAI,GAAJ,CAAtB,IAAkC,CAAC,CAAD,EAAI;AACxC,oBAAK,MAAL,CAAY,IAAZ,CAAiB,GAAjB,EADwC;cAA1C,MAEO,IAAI,KAAK,KAAL,CAAW,OAAX,CAAmB,IAAI,IAAJ,CAAnB,IAAgC,CAAC,CAAD,EAAI;AAC7C,oBAAK,SAAL,CAAe,IAAf,CAAoB,GAApB,EAD6C;cAAxC;YAJT;AAQA,gBAAK,IAAL,CAAU,IAAV,EA7BuC;UAAzC;;AAgCA,gBAAO,KAAK,IAAL,CAAU,UAAS,CAAT,EAAY,CAAZ,EAAe;AAC9B,kBAAO,EAAE,MAAF,GAAW,EAAE,MAAF,CADY;UAAf,CAAjB,CApCsC;QAAzB,CA9EoC;;AAuHnD,WAAI,uBAAuB,SAAvB,oBAAuB,CAAS,OAAT,EAAkB;AAC3C,aAAI,UAAU,EAAV,CADuC;AAE3C,cAAK,IAAI,CAAJ,IAAS,OAAd,EAAuB;AACrB,eAAI,MAAM,QAAQ,CAAR,CAAN,CADiB;AAErB,eAAI,IAAI,IAAJ,IAAY,YAAZ,IAA4B,IAAI,SAAJ,CAAc,iBAAd,IAAmC,MAAnC,EAA2C;AACzE,iBAAI,IAAI,SAAJ,CAAc,SAAd,IAA2B,IAAI,GAAJ,EAAS;AACtC,uBAAQ,IAAR,CAAa,GAAb,EADsC;cAAxC;YADF;UAFF;AAQA,gBAAO,QAAQ,IAAR,CAAa,WAAb,CAAP,CAV2C;QAAlB,CAvHwB;;AAoInD,WAAI,oBAAoB,SAApB,iBAAoB,CAAS,GAAT,EAAc;AACpC,cAAK,IAAI,CAAJ,IAAS,OAAO,gBAAP,EAAyB;AACrC,eAAI,OAAO,OAAO,gBAAP,CAAwB,CAAxB,CAAP,CADiC;AAErC,eAAI,KAAK,GAAL,IAAY,GAAZ,EAAiB;AACnB,oBAAO,IAAP,CADmB;YAArB;UAFF;QADsB,CApI2B;;AA6InD,WAAI,cAAc,SAAd,WAAc,CAAS,KAAT,EAAgB;AAChC,aAAI,OAAO,QAAQ,MAAM,GAAN,CAAf,CAD4B;AAEhC,cAAK,IAAI,CAAJ,IAAS,IAAd,EAAoB;AAClB,eAAI,MAAM,KAAK,CAAL,CAAN,CADc;AAElB,eAAI,IAAI,OAAJ,CAAY,GAAZ,KAAoB,CAAC,CAAD,EAAI;AAC1B,iBAAI,MAAM,IAAI,KAAJ,CAAU,GAAV,EAAe,CAAf,EAAkB,CAAlB,CAAN;iBACA,SAAS,IAAI,KAAJ,CAAU,IAAI,MAAJ,GAAa,CAAb,CAAV,CAA0B,KAA1B,CAAgC,GAAhC,CAAT,CAFsB;AAG1B,kBAAK,IAAI,CAAJ,IAAS,MAAd,EAAsB;AACpB,sBAAO,SAAP,CAAiB,kBAAkB,GAAlB,CAAjB,EAAyC,OAAO,CAAP,CAAzC,EADoB;cAAtB;YAHF;UAFF;QAFgB,CA7IiC;;AA2JnD,cAAO,SAAP,GAAmB,UAAS,IAAT,EAAe,KAAf,EAAsB;AACvC,qBAAY,mBAAZ,CAAgC,KAAK,GAAL,CAAhC,CAA0C,IAA1C,CAA+C,UAAS,GAAT,EAAc;AAC3D,kBAAO,OAAP,CAAe,IAAf,CAAoB;AAClB,kBAAK,KAAK,GAAL;AACL,mBAAM,IAAN;AACA,oBAAO,KAAP;AACA,qBAAQ,IAAI,IAAJ,CAAS,IAAT,CAAc,GAAd,CAAkB,UAAS,CAAT,EAAY;AACpC,sBAAO,EAAE,KAAK,GAAL,CAAT,CADoC;cAAZ,CAA1B;YAJF,EAD2D;UAAd,CAA/C,CADuC;QAAtB,CA3JgC;;AAwKnD,cAAO,YAAP,GAAsB,UAAS,MAAT,EAAiB;AACrC,aAAI,MAAM,OAAO,OAAP,CAAe,OAAf,CAAuB,MAAvB,CAAN,CADiC;AAErC,aAAI,OAAO,CAAC,CAAD,EAAI;AACb,kBAAO,OAAP,CAAe,MAAf,CAAsB,GAAtB,EAA2B,CAA3B,EADa;AAEb,kBAAO,aAAP,GAFa;UAAf;QAFoB,CAxK6B;;AAgLnD,cAAO,SAAP,GAAmB,UAAS,MAAT,EAAiB,IAAjB,EAAuB,KAAvB,EAA8B;AAC/C,gBAAO,aAAP,GAD+C;QAA9B,CAhLgC;;AAoLnD,cAAO,aAAP,GAAuB,YAAW;AAChC,aAAI,UAAU,EAAV,CAD4B;AAEhC,cAAK,IAAI,CAAJ,IAAS,OAAO,OAAP,EAAgB;AAC5B,eAAI,IAAI,OAAO,OAAP,CAAe,CAAf,CAAJ,CADwB;AAE5B,eAAI,QAAQ,WAAR,CAAoB,QAAQ,EAAE,GAAF,CAA5B,CAAJ,EAAyC;AACvC,qBAAQ,EAAE,GAAF,CAAR,GAAiB,EAAjB,CADuC;YAAzC;AAGA,mBAAQ,EAAE,GAAF,CAAR,CAAe,IAAf,CAAoB,EAAE,KAAF,CAApB,CAL4B;UAA9B;AAOA,aAAI,OAAO,EAAP,CAT4B;AAUhC,cAAK,IAAI,GAAJ,IAAW,OAAhB,EAAyB;AACvB,eAAI,SAAS,QAAQ,GAAR,CAAT;eACA,QAAQ,OAAO,IAAP,CAAY,GAAZ,CAAR,CAFmB;AAGnB,iBAAM,MAAM,GAAN,GAAY,KAAZ,CAHa;AAIvB,gBAAK,IAAL,CAAU,GAAV,EAJuB;UAAzB;AAMA,gBAAO,KAAP,CAAa,GAAb,GAAmB,IAAnB,CAhBgC;AAiBhC,kBAjBgC;QAAX,CApL4B;;AAwMnD,WAAI,cAAc,YAAY,SAAZ,CAAsB,UAAS,KAAT,EAAgB,GAAhB,EAAqB,KAArB,EAA4B;AAClE,iBAAQ,GAAR,CADkE;AAElE,gBAAO,KAAP,GAAe,KAAf,CAFkE;;AAIlE,aAAI,UAAU,aAAV,CAJ8D;AAKlE,gBAAO,IAAP,GAAc,SAAS,KAAT,EAAgB,OAAhB,CAAd,CALkE;AAMlE,gBAAO,gBAAP,GAA0B,qBAAqB,OAArB,CAA1B,CANkE;AAOlE,gBAAO,OAAP,GAAiB,EAAjB,CAPkE;AAQlE,qBAAY,KAAZ,EARkE;QAA5B,CAApC,CAxM+C;AAmNnD,cAAO,GAAP,CAAW,UAAX,EAAuB,WAAvB,EAnNmD;MAA/C;IANR,CADsG;EAApC,CAApE,E;;;;;;;;ACAA,WAAU,SAAV,CAAoB,eAApB,EAAqC,CAAC,YAAD,EAAe,OAAf,EAAwB,WAAxB,EAAqC,UAAS,UAAT,EAAqB,KAArB,EAA4B,SAA5B,EAAuC;AAC/G,UAAO;AACP,eAAU,IAAV;AACA,cAAS,UAAT;AACA,YAAO;AACL,kBAAW,GAAX;MADF;AAGA,kBAAa,+BAAb;AACA,WAAM,cAAS,KAAT,EAAgB,OAAhB,EAAyB,KAAzB,EAAgC,WAAhC,EAA6C;AACjD,WAAI,OAAO,EAAP;WACA,SAAS,EAAC,KAAK,OAAO,CAAP,EAAU,OAAO,CAAP,EAAU,QAAQ,CAAR,EAAW,MAAM,CAAN,EAA9C;WACA,MAAM,IAAN;WAAY,QAAQ,IAAR,CAHiC;;AAKjD,aAAM,WAAN,GAAoB,KAApB,CALiD;AAMjD,aAAM,aAAN,GAAsB,KAAtB,CANiD;AAOjD,aAAM,MAAN,GAAe,CAAf,CAPiD;;AASjD,WAAI,QAAQ,SAAR,KAAQ,CAAS,KAAT,EAAgB,KAAhB,EAAuB;AACjC,aAAI,SAAS,QAAQ,MAAM,MAAN,CAAR,CAAsB,CAAtB,CAAT;aACA,SAAS,QAAQ,MAAM,MAAN,CAAR,CAAsB,CAAtB,CAAT,CAF6B;AAG7B,qBAAY,QAAQ,MAAM,SAAN,CAAR,CAAyB,CAAzB,CAAZ,EACA,YAAY,YAAY,CAAC,SAAD,CAAZ,GAA0B,iBAAiB,KAAjB,CAA1B,CAJiB;;AAMjC,aAAI,IAAI,YAAY,QAAZ,EAAJ,CAN6B;AAOjC,WAAE,UAAF,GAAe,SAAf,CAPiC;AAQjC,aAAI,CAAC,MAAD,IAAW,CAAC,MAAD,EAAS;AACtB,kBADsB;UAAxB;AAGA,WAAE,SAAF,GAAc,CAAC,MAAD,EAAS,MAAT,CAAd,CAXiC;;AAajC,WAAE,KAAF,GAAU,CACR;AACE,gBAAK,SAAL;AACA,sBAAW,MAAX;UAHM,EAKR;AACE,gBAAK,MAAL;AACA,sBAAW,KAAX;UAPM,EASR;AACE,gBAAK,MAAL;AACA,sBAAW,KAAX;UAXM,CAAV,CAbiC;AA2BjC,WAAE,IAAF,GAAS,CAAT,CA3BiC;AA4BjC,WAAE,QAAF,GAAa,IAAb,CA5BiC;;AA8BjC,eAAM,WAAN,GAAoB,IAApB,CA9BiC;AA+BjC,eAAM,aAAN,GAAsB,KAAtB,CA/BiC;AAgCjC,aAAI,MAAM,MAAM,GAAN,CAAU,YAAY,SAAZ,CAAsB,WAAtB,CAAV,EACU,YAAY,WAAZ,CAAwB,CAAxB,CADV,CAAN,CAhC6B;;AAmCjC,aAAI,UAAU,QAAQ,gBAAR,CAAyB,iBAAzB,EAA4C,CAA5C,CAAV;aACA,OAAO,YAAY,IAAZ,CAAiB,OAAjB,EAA0B,UAAS,CAAT,EAAY;AAAE,kBAAO,IAAI,GAAJ,CAAT;UAAZ,CAAjC,CApC6B;;AAsCjC,gBAAO,KAAK,GAAL,CAAS,GAAT,EAAc,KAAK,MAAL,CAAd,GAA6B,EAA7B,CAtC0B;;AAwCjC,aAAI,CAAC,GAAD,EAAM;AACN,iBAAM,GAAG,MAAH,CAAU,OAAV,EAAmB,MAAnB,CAA0B,KAA1B,CAAN,CADM;AAEN,mBAAQ,IAAI,MAAJ,CAAW,GAAX,EACH,IADG,CACE,WADF,EACe,eAAe,OAAO,IAAP,GAAc,GAA7B,GAAmC,OAAO,GAAP,GAAa,GAAhD,CADvB,CAFM;UAAV;;AAMA,aAAI,IAAJ,CAAS,UAAS,GAAT,EAAc;AACrB,uBAAY,IAAZ,EAAkB,IAAI,IAAJ,EAAU,CAA5B,EAA+B,KAA/B,EAAsC,KAAtC,EADqB;UAAd,CAAT,CA9CiC;QAAvB,CATqC;;AA4DjD,WAAI,cAAc,SAAd,WAAc,CAAS,IAAT,EAAe,IAAf,EAAqB,CAArB,EAAwB,KAAxB,EAA+B,KAA/B,EAAsC;AACtD,aAAI,YAAY,QAAQ,MAAM,MAAN,CAAR,CAAsB,CAAtB,CAAZ;aACA,YAAY,QAAQ,MAAM,MAAN,CAAR,CAAsB,CAAtB,CAAZ,CAFkD;AAGlD,wBAAe,QAAQ,MAAM,SAAN,CAAR,CAAyB,CAAzB,CAAf,EACA,eAAe,eAAe,CAAC,YAAD,CAAf,GAAgC,iBAAiB,KAAjB,CAAhC,EACf,KAAK,MAAL,GAAc,KAAK,KAAL,CAAW,MAAX,GAAoB,IAApB,CALoC;;AAOtD,aAAI,IAAJ,CAAS,QAAT,EAAmB,KAAK,MAAL,GAAc,OAAO,GAAP,GAAa,OAAO,MAAP,CAA9C,CAPsD;AAQtD,aAAI,IAAJ,CAAS,OAAT,EAAkB,KAAK,KAAL,CAAlB,CARsD;;AAUtD,aAAI,QAAQ,EAAC,OAAO,EAAP,EAAW,OAAO,EAAP,EAApB;aACA,OAAO,EAAP,CAXkD;;AAatD,aAAI,cAAc,iBAAiB,UAAjB,CAA4B,IAA5B,EAAd;aACA,cAAc,GAAG,KAAH,CAAS,OAAT,GAAmB,KAAnB,CAAyB,CAAC,MAAD,EAAS,MAAT,EAAiB,MAAjB,EAAyB,MAAzB,CAAzB,CAAd,CAdkD;;AAgBtD,cAAK,KAAL,CAAW,OAAX,CAAmB,UAAS,IAAT,EAAe;AAChC,eAAI,WAAW,KAAK,SAAL,CAAX;eACA,WAAW,KAAK,SAAL,CAAX;eACA,OAAO;;AAEL,oBAAO,KAAK,YAAL,CAAP;AACA,qBAAQ,iBAAiB,YAAjB,CAA8B,KAAK,YAAL,CAA9B,CAAR;YAHF,CAH4B;;AAShC,eAAI,KAAK,KAAL,IAAc,CAAd,IAAmB,CAAC,QAAD,IAAa,CAAC,QAAD,EAAW;AAC7C,oBAD6C;YAA/C;AAGA,sBAAW,YAAY,SAAZ,GAAwB,QAAxB,CAZqB;AAahC,sBAAW,YAAY,SAAZ,GAAwB,QAAxB,CAbqB;;AAehC,eAAI,CAAC,KAAK,QAAL,CAAD,EAAiB;AACnB,iBAAI,QAAQ,KAAK,MAAM,SAAN,CAAgB,SAAhB,CAAL,CAAR,CADe;AAEnB,mBAAM,KAAN,CAAY,IAAZ,CAAiB;AACf,qBAAM,KAAN;AACA,sBAAO,YAAY,QAAZ,CAAP;cAFF,EAFmB;AAMnB,kBAAK,QAAL,IAAiB,EAAC,KAAK,MAAM,KAAN,CAAY,MAAZ,GAAqB,CAArB,EAAvB,CANmB;YAArB;AAQA,gBAAK,MAAL,GAAc,KAAK,QAAL,EAAe,GAAf,CAvBkB;;AAyBhC,eAAI,CAAC,KAAK,QAAL,CAAD,EAAiB;AACnB,iBAAI,QAAQ,KAAK,MAAM,SAAN,CAAgB,SAAhB,CAAL,CAAR,CADe;AAEnB,mBAAM,KAAN,CAAY,IAAZ,CAAiB;AACf,qBAAM,KAAN;AACA,sBAAO,YAAY,QAAZ,CAAP;cAFF,EAFmB;AAMnB,kBAAK,QAAL,IAAiB;AACf,oBAAK,MAAM,KAAN,CAAY,MAAZ,GAAqB,CAArB;cADP,CANmB;YAArB;AAUA,gBAAK,MAAL,GAAc,KAAK,QAAL,EAAe,GAAf,CAnCkB;AAoChC,iBAAM,KAAN,CAAY,IAAZ,CAAiB,IAAjB,EApCgC;UAAf,CAAnB,CAhBsD;;AAuDtD,aAAI,SAAS,GAAG,MAAH,GACT,SADS,CACC,IADD,EAET,WAFS,CAEG,OAAO,GAAP,CAFH,CAGT,IAHS,CAGJ,CAAC,KAAK,KAAL,EAAY,KAAK,MAAL,CAHT,CAAT,CAvDkD;;AA4DtD,aAAI,OAAO,OAAO,IAAP,EAAP,CA5DkD;;AA8DtD,gBACG,KADH,CACS,MAAM,KAAN,CADT,CAEG,KAFH,CAES,MAAM,KAAN,CAFT,CAGG,MAHH,CAGU,EAHV,EA9DsD;;AAmEtD,eAAM,SAAN,CAAgB,GAAhB,EAAqB,MAArB,GAnEsD;;AAqEtD,aAAI,OAAO,MAAM,MAAN,CAAa,GAAb,EAAkB,SAAlB,CAA4B,OAA5B,EACN,IADM,CACD,MAAM,KAAN,CADC,CAER,KAFQ,GAEA,MAFA,CAEO,MAFP,EAGN,IAHM,CAGD,OAHC,EAGQ,MAHR,EAIN,IAJM,CAID,GAJC,EAII,IAJJ,EAKN,KALM,CAKA,cALA,EAKgB,UAAS,CAAT,EAAY;AACjC,kBAAO,KAAK,GAAL,CAAS,CAAT,EAAY,EAAE,EAAF,CAAnB,CADiC;UAAZ,CALhB,CAQN,KARM,CAQA,QARA,EAQU,UAAS,CAAT,EAAY;AAC3B,kBAAO,EAAE,MAAF,CAAS,KAAT,CADoB;UAAZ,CARV,CAWN,IAXM,CAWD,UAAS,CAAT,EAAY,CAAZ,EAAe;AAAE,kBAAO,EAAE,EAAF,GAAO,EAAE,EAAF,CAAhB;UAAf,CAXN,CArEkD;;AAkFtD,cAAK,MAAL,CAAY,OAAZ,EACK,IADL,CACU,UAAS,CAAT,EAAY;AAAE,kBAAO,EAAE,MAAF,CAAS,IAAT,GAAgB,KAAhB,GAAwB,EAAE,MAAF,CAAS,IAAT,GAAgB,IAAxC,GAA+C,EAAE,MAAF,CAAxD;UAAZ,CADV,CAlFsD;;AAqFtD,aAAI,OAAO,MAAM,MAAN,CAAa,GAAb,EAAkB,SAAlB,CAA4B,OAA5B,EACN,IADM,CACD,MAAM,KAAN,CADC,CAER,KAFQ,GAEA,MAFA,CAEO,GAFP,EAGN,IAHM,CAGD,OAHC,EAGQ,MAHR,EAIN,IAJM,CAID,WAJC,EAIY,UAAS,CAAT,EAAY;AAAE,kBAAO,eAAe,EAAE,CAAF,GAAM,GAArB,GAA2B,EAAE,CAAF,GAAM,GAAjC,CAAT;UAAZ,CAJnB,CArFkD;;AA2FtD,cAAK,MAAL,CAAY,MAAZ,EACK,IADL,CACU,QADV,EACoB,UAAS,CAAT,EAAY;AAAE,kBAAO,EAAE,EAAF,CAAT;UAAZ,CADpB,CAEK,IAFL,CAEU,OAFV,EAEmB,OAAO,SAAP,EAFnB,EAGK,KAHL,CAGW,MAHX,EAGmB,UAAS,CAAT,EAAY;AAAE,kBAAO,EAAE,KAAF,CAAT;UAAZ;;AAHnB,UAKK,KALL,CAKW,QALX,EAKqB,UAAS,CAAT,EAAY;AAAE,kBAAO,EAAE,KAAF,CAAT;UAAZ,CALrB,CAMG,MANH,CAMU,OANV,EAOK,IAPL,CAOU,UAAS,CAAT,EAAY;AAAE,kBAAO,EAAE,IAAF,CAAT;UAAZ,CAPV,CA3FsD;;AAoGtD,cAAK,MAAL,CAAY,MAAZ,EACK,IADL,CACU,GADV,EACe,CAAC,CAAD,CADf,CAEK,IAFL,CAEU,GAFV,EAEe,UAAS,CAAT,EAAY;AAAE,kBAAO,EAAE,EAAF,GAAO,CAAP,CAAT;UAAZ,CAFf,CAGK,IAHL,CAGU,IAHV,EAGgB,OAHhB,EAIK,IAJL,CAIU,aAJV,EAIyB,KAJzB,EAKK,IALL,CAKU,WALV,EAKuB,IALvB,EAMK,IANL,CAMU,UAAS,CAAT,EAAY;AAAE,kBAAO,EAAE,IAAF,CAAT;UAAZ,CANV,CAOG,MAPH,CAOU,UAAS,CAAT,EAAY;AAAE,kBAAO,EAAE,CAAF,GAAM,KAAK,KAAL,GAAa,CAAb,CAAf;UAAZ,CAPV,CAQK,IARL,CAQU,GARV,EAQe,IAAI,OAAO,SAAP,EAAJ,CARf,CASK,IATL,CASU,aATV,EASyB,OATzB,EApGsD;;AA+GtD,eAAM,aAAN,GAAsB,KAAK,gBAAL,GAAwB,EAAE,QAAF,CA/GQ;AAgHtD,eAAM,MAAN,GAAe,EAAE,QAAF,CAhHuC;QAAtC,CA5D+B;;AA+KjD,WAAI,cAAc,YAAY,SAAZ,CAAsB,UAAS,KAAT,EAAgB,KAAhB,EAAuB,KAAvB,EAA8B;AACpE,eAAM,KAAN,EAAa,KAAb,EADoE;QAA9B,CAApC,CA/K6C;AAkLjD,aAAM,GAAN,CAAU,UAAV,EAAsB,WAAtB,EAlLiD;;AAoLjD,WAAI,mBAAmB,SAAnB,gBAAmB,CAAS,KAAT,EAAgB;AACrC,cAAK,IAAI,CAAJ,IAAS,MAAM,UAAN,EAAkB;AAC9B,eAAI,MAAM,MAAM,UAAN,CAAiB,CAAjB,CAAN,CAD0B;AAE9B,eAAI,IAAI,OAAJ,EAAa;AACf,oBAAO,CAAC,IAAI,GAAJ,CAAR,CADe;YAAjB;UAFF;AAMA,gBAAO,EAAP,CAPqC;QAAhB,CApL0B;;AA8LjD,mBAAY,IAAZ,CAAiB;AACf,iBAAQ;AACN,kBAAO,QAAP;AACA,qBAAU,eAAV;AACA,kBAAO,CAAC,YAAD,CAAP;AACA,qBAAU,EAAV;AACA,mBAAQ,CAAR;AACA,qBAAU,KAAV;UANF;AAQA,iBAAQ;AACN,kBAAO,QAAP;AACA,qBAAU,gBAAV;AACA,kBAAO,CAAC,YAAD,CAAP;AACA,qBAAU,EAAV;AACA,mBAAQ,CAAR;AACA,qBAAU,KAAV;UANF;AAQA,oBAAW;AACT,kBAAO,OAAP;AACA,qBAAU,WAAV;AACA,kBAAO,CAAC,YAAD,CAAP;AACA,qBAAU,gBAAV;AACA,mBAAQ,CAAR;AACA,qBAAU,KAAV;UANF;;QAjBF,EA9LiD;MAA7C;IAPN,CAD+G;EAAvC,CAA1E,E;;;;;;;;ACAA,WAAU,SAAV,CAAoB,gBAApB,EAAsC,CAAC,YAAD,EAAe,OAAf,EAAwB,WAAxB,EAAqC,UAAS,UAAT,EAAqB,KAArB,EAA4B,SAA5B,EAAuC;AAChH,UAAO;AACP,eAAU,IAAV;AACA,cAAS,UAAT;AACA,YAAO;AACL,kBAAW,GAAX;MADF;AAGA,kBAAa,gCAAb;AACA,WAAM,cAAS,KAAT,EAAgB,OAAhB,EAAyB,KAAzB,EAAgC,WAAhC,EAA6C;AACjD,WAAI,UAAU,IAAV;WACA,MAAM,IAAN,CAF6C;;AAIjD,aAAM,WAAN,GAAoB,KAApB,CAJiD;AAKjD,aAAM,aAAN,GAAsB,KAAtB,CALiD;;AAOjD,WAAI,QAAQ,SAAR,KAAQ,CAAS,KAAT,EAAgB,KAAhB,EAAuB;AACjC,aAAI,OAAO,QAAQ,MAAM,IAAN,CAAR,CAAoB,CAApB,CAAP;aACA,OAAO,QAAQ,MAAM,IAAN,CAAR,CAAoB,CAApB,CAAP;aACA,OAAO,OAAO,CAAC,IAAD,CAAP,GAAgB,YAAY,KAAZ,CAAhB,CAHsB;;AAKjC,aAAI,IAAI,YAAY,QAAZ,EAAJ,CAL6B;AAMjC,WAAE,UAAF,GAAe,IAAf,CANiC;AAOjC,aAAI,CAAC,IAAD,EAAO;AACT,kBADS;UAAX;AAGA,WAAE,SAAF,GAAc,CAAC,IAAD,CAAd,CAViC;;AAYjC,aAAI,QAAQ,EAAR,CAZ6B;AAajC,cAAK,IAAI,CAAJ,IAAS,EAAE,KAAF,EAAS;AACrB,eAAI,IAAI,EAAE,KAAF,CAAQ,CAAR,CAAJ,CADiB;AAErB,eAAI,CAAC,IAAD,EAAO,IAAP,EAAa,OAAb,CAAqB,EAAE,GAAF,CAArB,IAA+B,CAAC,CAAD,EAAI;AACrC,mBAAM,IAAN,CAAW,CAAX,EADqC;YAAvC;UAFF;AAMA,aAAI,CAAC,MAAM,MAAN,EAAc;AACjB,mBAAQ,CAAC,EAAC,KAAK,IAAL,EAAW,WAAW,MAAX,EAAb,CAAR,CADiB;UAAnB;;AAIA,WAAE,KAAF,GAAU,KAAV,CAvBiC;AAwBjC,WAAE,IAAF,GAAS,CAAT,CAxBiC;AAyBjC,WAAE,QAAF,GAAa,EAAb,CAzBiC;;AA2BjC,eAAM,aAAN,GAAsB,KAAtB,CA3BiC;AA4BjC,eAAM,WAAN,GAAoB,IAApB,CA5BiC;AA6BjC,aAAI,MAAM,MAAM,GAAN,CAAU,YAAY,SAAZ,CAAsB,WAAtB,CAAV,EACU,YAAY,WAAZ,CAAwB,CAAxB,CADV,CAAN,CA7B6B;;AAgCjC,aAAI,UAAU,QAAQ,gBAAR,CAAyB,kBAAzB,EAA6C,CAA7C,CAAV;aACA,OAAO,YAAY,IAAZ,CAAiB,OAAjB,EAA0B,UAAS,CAAT,EAAY;AAAE,kBAAO,IAAI,GAAJ,CAAT;UAAZ,CAAjC,CAjC6B;;AAmCjC,mBAAU,GAAG,MAAH,CAAU,OAAV,GACP,IADO,CACF,CAAC,KAAK,KAAL,EAAY,KAAK,MAAL,CADX,EAEP,MAFO,CAEA,IAFA,EAGP,IAHO,CAGF,UAAS,CAAT,EAAY,CAAZ,EAAe;AAAE,kBAAO,EAAE,IAAF,IAAU,EAAE,IAAF,CAAV,CAAT;UAAf,CAHE,CAIP,KAJO,CAID,UAAS,CAAT,EAAY;AAAE,kBAAO,EAAE,IAAF,CAAP,CAAF;UAAZ,CAJT,CAnCiC;;AAyCjC,YAAG,MAAH,CAAU,OAAV,EAAmB,MAAnB,CAA0B,KAA1B,EAAiC,MAAjC,GAzCiC;AA0CjC,eAAM,GAAG,MAAH,CAAU,OAAV,EAAmB,MAAnB,CAA0B,KAA1B,EACH,KADG,CACG,UADH,EACe,UADf,EAEH,KAFG,CAEG,OAFH,EAEY,KAAK,KAAL,GAAa,IAAb,CAFZ,CAGH,KAHG,CAGG,QAHH,EAGa,KAAK,MAAL,GAAc,IAAd,CAHnB,CA1CiC;;AA+CjC,aAAI,IAAJ,CAAS,UAAS,GAAT,EAAc;AACrB,uBAAY,IAAI,IAAJ,EAAU,CAAtB,EAAyB,KAAzB,EAAgC,KAAhC,EADqB;UAAd,CAAT,CA/CiC;QAAvB,CAPqC;;AA2DjD,WAAI,cAAc,SAAd,WAAc,CAAS,IAAT,EAAe,CAAf,EAAkB,KAAlB,EAAyB,KAAzB,EAAgC;AAChD,aAAI,UAAU,QAAQ,MAAM,IAAN,CAAR,CAAoB,CAApB,CAAV;aACA,UAAU,QAAQ,MAAM,IAAN,CAAR,CAAoB,CAApB,CAAV;aACA,UAAU,UAAU,CAAC,OAAD,CAAV,GAAsB,YAAY,KAAZ,CAAtB,CAHkC;;AAKhD,aAAI,OAAO;AACT,qBAAU,EAAV;UADE,CAL4C;;AAShD,cAAK,IAAI,CAAJ,IAAS,KAAK,KAAL,EAAY;AACxB,eAAI,OAAO,KAAK,KAAL,CAAW,CAAX,CAAP,CADoB;AAExB,gBAAK,SAAL,GAAiB,iBAAiB,YAAjB,CAA8B,KAAK,KAAL,CAAW,KAAK,OAAL,CAAX,CAA9B,CAAjB,CAFwB;AAGxB,gBAAK,KAAL,GAAa,KAAK,OAAL,CAAb,CAHwB;AAIxB,gBAAK,MAAL,GAAc,iBAAiB,UAAjB,CAA4B,CAA5B,CAAd,CAJwB;AAKxB,gBAAK,WAAL,GAAmB,KAAK,OAAL,IAAgB,KAAK,GAAL,CAAS,KAAK,OAAL,CAAa,OAAb,CAAT,EAAgC,CAAhC,CAAhB,CALK;AAMxB,gBAAK,QAAL,CAAc,IAAd,CAAmB,IAAnB,EANwB;UAA1B,CATgD;;AAkBhD,aAAI,OAAO,IAAI,KAAJ,CAAU,IAAV,EAAgB,SAAhB,CAA0B,OAA1B,EACN,IADM,CACD,QAAQ,KAAR,CADC,CAER,KAFQ,GAEA,MAFA,CAEO,GAFP,EAGN,IAHM,CAGD,MAHC,EAGO,UAAS,CAAT,EAAW;AAAE,kBAAO,EAAE,IAAF,CAAT;UAAX,CAHP,CAIN,IAJM,CAID,OAJC,EAIQ,MAJR,EAKN,IALM,CAKD,YALC,EAMN,KANM,CAMA,YANA,EAMc,MANd,EAON,IAPM,CAOD,UAAS,CAAT,EAAY;AAChB,eAAI,EAAE,WAAF,GAAgB,IAAhB,EAAsB;AACxB,oBAAO,EAAP,CADwB;YAA1B;AAGA,kBAAO,EAAE,QAAF,GAAa,IAAb,GAAoB,0BAA0B,EAAE,SAAF,GAAc,SAAxC,GAAoD,EAAE,KAAF,CAJ/D;UAAZ,CAPC,CAaN,EAbM,CAaH,WAbG,EAaU,UAAS,CAAT,EAAY;AAC3B,cAAG,MAAH,CAAU,IAAV,EAAgB,UAAhB,GAA6B,QAA7B,CAAsC,GAAtC,EACG,KADH,CACS,EAAC,cAAc,GAAG,GAAH,CAAO,EAAE,MAAF,CAAP,CAAiB,MAAjB,EAAd,EADV,EAD2B;UAAZ,CAbV,CAiBN,EAjBM,CAiBH,UAjBG,EAiBS,UAAS,CAAT,EAAY;AAC1B,cAAG,MAAH,CAAU,IAAV,EAAgB,UAAhB,GAA6B,QAA7B,CAAsC,GAAtC,EACG,KADH,CACS,EAAC,cAAc,EAAE,MAAF,EADxB,EAD0B;UAAZ,CAjBT,CAqBN,UArBM,GAsBN,QAtBM,CAsBG,GAtBH,EAuBN,KAvBM,CAuBA,UAAS,CAAT,EAAY,CAAZ,EAAe;AAAE,kBAAO,KAAK,GAAL,CAAS,IAAI,EAAJ,EAAQ,IAAjB,CAAP,CAAF;UAAf,CAvBA,CAwBN,KAxBM,CAwBA,YAxBA,EAwBc,UAAS,CAAT,EAAY;AAAE,kBAAO,EAAE,MAAF,CAAT;UAAZ,CAxBrB,CAlB4C;;AA4ChD,eAAM,aAAN,GAAsB,KAAK,gBAAL,GAAwB,EAAE,QAAF,CA5CE;AA6ChD,eAAM,MAAN,GAAe,EAAE,QAAF,CA7CiC;QAAhC,CA3D+B;;AA2GjD,gBAAS,YAAT,GAAwB;AACtB,cAAK,KAAL,CAAW,MAAX,EAAmB,UAAS,CAAT,EAAY;AAAE,kBAAO,EAAE,CAAF,GAAM,IAAN,CAAT;UAAZ,CAAnB,CACK,KADL,CACW,KADX,EACkB,UAAS,CAAT,EAAY;AAAE,kBAAO,EAAE,CAAF,GAAM,IAAN,CAAT;UAAZ,CADlB,CAEK,KAFL,CAEW,OAFX,EAEoB,UAAS,CAAT,EAAY;AAAE,kBAAO,KAAK,GAAL,CAAS,CAAT,EAAY,EAAE,EAAF,GAAO,CAAP,CAAZ,GAAwB,IAAxB,CAAT;UAAZ,CAFpB,CAGK,KAHL,CAGW,QAHX,EAGqB,UAAS,CAAT,EAAY;AAAE,kBAAO,KAAK,GAAL,CAAS,CAAT,EAAY,EAAE,EAAF,GAAO,CAAP,CAAZ,GAAwB,IAAxB,CAAT;UAAZ,CAHrB,CADsB;QAAxB,CA3GiD;;AAmHjD,WAAI,cAAc,YAAY,SAAZ,CAAsB,UAAS,KAAT,EAAgB,KAAhB,EAAuB,KAAvB,EAA8B;AACpE,eAAM,KAAN,EAAa,KAAb,EADoE;QAA9B,CAApC,CAnH6C;AAsHjD,aAAM,GAAN,CAAU,UAAV,EAAsB,WAAtB,EAtHiD;;AAwHjD,WAAI,cAAc,SAAd,WAAc,CAAS,KAAT,EAAgB;AAChC,cAAK,IAAI,CAAJ,IAAS,MAAM,UAAN,EAAkB;AAC9B,eAAI,MAAM,MAAM,UAAN,CAAiB,CAAjB,CAAN,CAD0B;AAE9B,eAAI,IAAI,OAAJ,EAAa;AACf,oBAAO,CAAC,IAAI,GAAJ,CAAR,CADe;YAAjB;UAFF;AAMA,gBAAO,EAAP,CAPgC;QAAhB,CAxH+B;;AAkIjD,mBAAY,IAAZ,CAAiB;AACf,eAAM;AACJ,kBAAO,OAAP;AACA,qBAAU,eAAV;AACA,kBAAO,CAAC,YAAD,CAAP;AACA,qBAAU,EAAV;AACA,mBAAQ,CAAR;AACA,qBAAU,KAAV;UANF;AAQA,eAAM;AACJ,kBAAO,MAAP;AACA,qBAAU,UAAV;AACA,kBAAO,CAAC,YAAD,CAAP;AACA,qBAAU,WAAV;AACA,mBAAQ,CAAR;AACA,qBAAU,KAAV;UANF;QATF,EAlIiD;MAA7C;IAPN,CADgH;EAAvC,CAA3E,E;;;;;;;;ACAA,UAAS,OAAT,CAAiB,GAAjB,EAAsB;AACpB,UAAO,MAAM,GAAN,GAAY,EAAZ,CADa;AAEpB,UAAO,QAAQ,OAAR,CAAgB,IAAhB,IAAwB,IAAxB,GAA+B,CAAC,IAAD,CAA/B,CAFa;EAAtB;;AAKA,UAAS,SAAT,GAAqB;AACnB,UAAO,MAAM,KAAK,MAAL,GAAc,QAAd,CAAuB,EAAvB,EAA2B,SAA3B,CAAqC,CAArC,CAAN,CADY;EAArB;;;;AAMA,KAAI,CAAC,OAAO,SAAP,CAAiB,QAAjB,EAA2B;AAC9B,UAAO,SAAP,CAAiB,QAAjB,GAA4B,UAAS,YAAT,EAAuB,QAAvB,EAAiC;AACzD,SAAI,gBAAgB,KAAK,QAAL,EAAhB,CADqD;AAEzD,SAAI,aAAa,SAAb,IAA0B,WAAW,cAAc,MAAd,EAAsB;AAC7D,kBAAW,cAAc,MAAd,CADkD;MAA/D;AAGA,iBAAY,aAAa,MAAb,CAL6C;AAMzD,SAAI,YAAY,cAAc,OAAd,CAAsB,YAAtB,EAAoC,QAApC,CAAZ,CANqD;AAOzD,YAAO,cAAc,CAAC,CAAD,IAAM,cAAc,QAAd,CAP8B;IAAjC,CADE;;;;;;;;;ACXhC,WAAU,SAAV,CAAoB,kBAApB,EAAwC,CAAC,WAAD,EAAc,UAAS,SAAT,EAAoB;AACxE,UAAO;AACL,eAAU,IAAV;AACA,YAAO;AACL,iBAAU,GAAV;AACA,aAAM,GAAN;MAFF;AAIA,kBAAa,kCAAb;AACA,WAAM,cAAS,KAAT,EAAgB,OAAhB,EAAyB,KAAzB,EAAgC;AACpC,aAAM,KAAN,GAAc,IAAd,CADoC;AAEpC,aAAM,SAAN,GAAkB,IAAlB,CAFoC;;AAIpC,aAAM,OAAN,GAAgB,UAAS,IAAT,EAAe;AAC7B,eAAM,IAAN,GAAa,IAAb,CAD6B;AAE7B,eAAM,KAAN,CAAY,IAAZ,GAAmB,IAAnB,CAF6B;AAG7B,eAAM,MAAN,CAAa,MAAM,KAAN,CAAb,CAH6B;QAAf,CAJoB;;AAUpC,aAAM,MAAN,GAAe,UAAS,KAAT,EAAgB;AAC7B,eAAM,KAAN,GAAc,KAAd,CAD6B;AAE7B,eAAM,IAAN,GAAa,MAAM,KAAN,CAAY,IAAZ,IAAoB,OAApB,CAFgB;AAG7B,mBAAU,MAAV,CAAiB,KAAjB,EAH6B;AAI7B,wBAJ6B;QAAhB,CAVqB;;AAiBpC,WAAI,eAAe,SAAf,YAAe,GAAW;AAC5B,aAAI,KAAK,EAAL;aACA,OAAO,QAAQ,MAAR,CAAe,EAAf,EAAmB,UAAU,MAAV,EAAnB,EAAuC;AAC5C,iBAAM,MAAM,IAAN;AACN,qBAAU,MAAM,QAAN;AACV,iBAAM,MAAM,IAAN;AACN,kBAAO,IAAP;UAJK,CAAP,CAFwB;AAQ5B,cAAK,IAAI,IAAJ,IAAY,IAAjB,EAAuB;AACrB,eAAI,SAAS,QAAQ,KAAK,IAAL,CAAR,CAAT,CADiB;AAErB,gBAAK,IAAI,CAAJ,IAAS,MAAd,EAAsB;AACpB,iBAAI,MAAM,mBAAmB,OAAO,CAAP,CAAnB,CAAN,CADgB;AAEpB,gBAAG,IAAH,CAAQ,OAAO,GAAP,GAAa,GAAb,CAAR,CAFoB;YAAtB;UAFF;AAOA,eAAM,SAAN,GAAkB,iBAAiB,SAAjB,GAA6B,KAA7B,GAAqC,GAAG,IAAH,CAAQ,GAAR,CAArC,CAfU;QAAX,CAjBiB;;AAmCpC,aAAM,MAAN,CAAa,UAAU,MAAV,EAAb,EAnCoC;MAAhC;IAPR,CADwE;EAApB,CAAtD,E","file":"babbage.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"Babbage\"] = factory();\n\telse\n\t\troot[\"Babbage\"] = factory();\n})(this, function() {\nreturn \n\n\n/** WEBPACK FOOTER **\n ** webpack/universalModuleDefinition\n **/"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap fd23408fe4efac681638\n **/","require('./app')\nrequire('./api')\nrequire('./babbage')\nrequire('./chart')\nrequire('./crosstab')\nrequire('./facts')\nrequire('./pager')\nrequire('./panel')\nrequire('./sankey')\nrequire('./treemap')\nrequire('./util')\nrequire('./workspace')\n\nmodule.exports = 'ngBabbage'\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/index.js\n **/","\nngBabbage.factory('babbageApi', ['$http', '$q', 'slugifyFilter', function($http, $q, slugifyFilter) {\n  var cache = {};\n\n  var getUrl = function(endpoint, cube, path) {\n    var api = endpoint.slice(),\n        api = api.endsWith('/') ? api.slice(0, api.length - 1) : api,\n        api = api + '/cubes/' + cube + '/' + path;\n    return api;\n  };\n\n  var getCached = function(url) {\n    if (!angular.isDefined(cache[url])) {\n      cache[url] = $http.get(url);\n    }\n    return cache[url];\n  };\n\n  var getModel = function(endpoint, cube) {\n    return getCached(getUrl(endpoint, cube, 'model')).then(function(res) {\n      var model = res.data.model;\n      model.refs = {};\n      model.refKeys = {};\n      model.refLabels = {};\n\n      for (var i in model.measures) {\n        var measure = model.measures[i];\n        measure.numeric = true;\n        measure.hideLabel = true;\n        model.refs[measure.ref] = measure;\n      }\n\n      for (var i in model.aggregates) {\n        var agg = model.aggregates[i];\n        agg.numeric = true;\n        agg.hideLabel = true;\n        model.refs[agg.ref] = agg;\n      }\n\n      for (var di in model.dimensions) {\n        var dim = model.dimensions[di];\n        for (var ai in dim.attributes) {\n          var attr = dim.attributes[ai],\n              nested = attr.ref.indexOf('.') != -1;\n          attr.dimension = dim;\n          attr.hideLabel = slugifyFilter(attr.label) == slugifyFilter(dim.label);\n          model.refs[attr.ref] = attr;\n          model.refKeys[attr.ref] = nested ? dim.name + '.' + dim.key_attribute : attr.ref;\n          model.refLabels[attr.ref] = nested ? dim.name + '.' + dim.label_attribute : attr.ref;\n        }\n      }\n      return model;\n    });\n  };\n\n  var getDimensionMembers = function(endpoint, cube, dimension) {\n    return getCached(getUrl(endpoint, cube, 'members/' + dimension));\n  };\n\n  var flush = function() {\n    cache = {};\n  };\n\n  return {\n    getUrl: getUrl,\n    getModel: getModel,\n    getDimensionMembers: getDimensionMembers,\n    flush: flush\n  };\n}]);\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/api.js\n **/","var ngBabbage = angular.module('ngBabbage', ['ngBabbage.templates']);\n\nvar ngBabbageGlobals = ngBabbageGlobals || {};\nngBabbageGlobals.numberFormat = d3.format(\"0,000\");\nngBabbageGlobals.categoryColors = [\n    \"#CF3D1E\", \"#F15623\", \"#F68B1F\", \"#FFC60B\", \"#DFCE21\",\n    \"#BCD631\", \"#95C93D\", \"#48B85C\", \"#00833D\", \"#00B48D\",\n    \"#60C4B1\", \"#27C4F4\", \"#478DCB\", \"#3E67B1\", \"#4251A3\", \"#59449B\",\n    \"#6E3F7C\", \"#6A246D\", \"#8A4873\", \"#EB0080\", \"#EF58A0\", \"#C05A89\"\n    ];\nngBabbageGlobals.colorScale = d3.scale.ordinal().range(ngBabbageGlobals.categoryColors);\n\nif(!ngBabbageGlobals.embedSite) {\n  var url = window.location.href.split('#')[0],\n      lastSlash = url.lastIndexOf('/'),\n      lastSlash = lastSlash == -1 ? url.length : lastSlash;\n  ngBabbageGlobals.embedSite = url.slice(0, lastSlash);\n}\nngBabbageGlobals.embedLink = ngBabbageGlobals.embedSite + '/embed.html';\n\n\nngBabbage.filter('numeric', function() {\n  return function(val) {\n    var fval = parseFloat(val)\n    if (isNaN(fval)) {\n      return '-';\n    }\n    return ngBabbageGlobals.numberFormat(Math.round(fval));\n  };\n});\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/app.js\n **/","\nngBabbage.directive('babbage', ['$http', '$rootScope', '$location', 'babbageApi',\n    function($http, $rootScope, $location, babbageApi) {\n  return {\n    restrict: 'E',\n    transclude: true,\n    scope: {\n      endpoint: '@',\n      cube: '@',\n      state: '=',\n      update: '&'\n    },\n    templateUrl: 'babbage-templates/babbage.html',\n    controller: ['$scope', function($scope) {\n      var self = this;\n      self.queryModel = null;\n\n      self.init = function(queryModel) {\n        self.queryModel = queryModel;\n        self.update();\n      };\n\n      self.update = function() {\n        if (self.queryModel) {\n          babbageApi.getModel($scope.endpoint, $scope.cube).then(function(model) {\n            $scope.$broadcast('babbageUpdate', model, $scope.state);\n          });\n        }\n      }\n\n      self.subscribe = function(listener) {\n        return $scope.$on('babbageUpdate', listener);\n      };\n\n      self.getState = function() {\n        return $scope.state;\n      };\n\n      self.isEmbedded = function() {\n        return $scope.state.embed == 'true';\n      };\n\n      self.setState = function(s) {\n        $scope.state = s;\n        self.update();\n        $scope.update(s);\n      };\n\n      self.getApiUrl = function(endpoint) {\n        return babbageApi.getUrl($scope.endpoint, $scope.cube, endpoint);\n      };\n\n      self.getDimensionMembers = function(dimension) {\n        return babbageApi.getDimensionMembers($scope.endpoint, $scope.cube, dimension);\n      };\n\n      self.size = function(element, height) {\n        if (self.isEmbedded()) {\n            return {\n              width: document.documentElement.clientWidth,\n              height: document.documentElement.clientHeight\n            }\n        }\n        return {\n          width: element.clientWidth,\n          height: height(element.clientWidth, element.clientHeight)\n        }\n      };\n\n      self.getSorts = function() {\n        var sorts = [],\n            order = $scope.state.order || '',\n            order = asArray(order.split(','));\n        for (var i in order) {\n          var parts = order[i].split(':'),\n              sort = {};\n          sort.ref = parts[0];\n          sort.direction = parts[1] || null;\n          if (sort.ref.length) {\n              sorts.push(sort);\n          }\n        }\n        return sorts;\n      };\n\n      self.getSort = function(ref) {\n        var sorts = self.getSorts();\n        for (var i in sorts) {\n          if (sorts[i].ref == ref) {\n            return sorts[i];\n          }\n        }\n        return {ref: ref};\n      };\n\n      self.pushSort = function(ref, direction) {\n        var sorts = self.getSorts().filter(function(s) {\n          return s.ref != ref;\n        });\n        sorts.unshift({ref: ref, direction: direction});\n        $scope.state.order = self.mergeSorts(sorts);\n        self.setState($scope.state);\n      };\n\n      self.removeSorts = function(ref) {\n        var sorts = self.getSorts().filter(function(s) {\n          return s.ref != ref;\n        });\n        return self.mergeSorts(sorts);\n      };\n\n      self.mergeSorts = function(order) {\n        var sorts = [];\n        order = asArray(order);\n        for (var i in order) {\n          var o = order[i];\n          if (angular.isObject(o) && o.ref.length) {\n            o.direction = o.direction || 'asc';\n            o = o.ref + ':' + o.direction;\n            sorts.push(o);\n          }\n        }\n        return sorts.join(',');\n      };\n\n      self.getQuery = function() {\n        var q = {\n          drilldown: [],\n          aggregates: [],\n          cut: $scope.state.cut || [],\n          page: $scope.state.page || 0,\n          pagesize: $scope.state.pagesize || 30,\n          order: self.getSorts()\n        };\n        return q;\n      };\n\n      self.queryParams = function(q) {\n        q.order = self.mergeSorts(q.order);\n\n        // join arguments and remove empty arguments\n        for (var k in q) {\n          if (angular.isArray(q[k])) {\n            if (['order', 'fields'].indexOf(k) != -1) {\n              q[k] = q[k].join(',');\n            } else {\n              q[k] = q[k].join('|');\n            }\n          }\n          q[k] = q[k] + '';\n          if (!q[k].length) {\n            delete q[k];\n          }\n        }\n        return {params: q};\n      }\n    }]\n  };\n}]);\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/babbage.js\n **/","\nngBabbage.directive('babbageChart', ['$rootScope', '$http', function($rootScope, $http) {\n  return {\n    restrict: 'EA',\n    require: '^babbage',\n    scope: {\n      chartType: '@'\n    },\n    templateUrl: 'babbage-templates/chart.html',\n    link: function(scope, element, attrs, babbageCtrl) {\n      scope.queryLoaded = false;\n      scope.cutoffWarning = false;\n      scope.cutoff = 0;\n\n      var getNames = function(model) {\n        var names = {};\n        for (var ref in model.refs) {\n          var concept = model.refs[ref];\n          names[ref] = concept.label || concept.name || ref;\n        }\n        return names;\n      };\n\n      var generateColumns = function(cells, category, grouping, value) {\n        var columns = [[category]], series = {category: 0};\n        for (var i in cells) {\n          var cell = cells[i],\n              field = grouping ? cell[grouping] : value;\n          if (!series[field]) {\n            series[field] = columns.push([field]) - 1;\n          }\n          if (columns[0].indexOf(cell[category]) < 1) {\n            columns[0].push(cell[category]);\n          }\n          var index = columns[0].indexOf(cell[category]);\n          columns[series[field]][index] = cell[value];\n        }\n        var maxLength = Math.max.apply(null, columns.map(function(r) {\n          return r.length;\n        }));\n        for (var i = 1; i < maxLength; i++) {\n          for (var j in columns) {\n            columns[j][i] = columns[j][i] || 0;\n          }\n        }\n        return columns;\n      };\n\n      var query = function(model, state) {\n        var category = asArray(state.category)[0],\n            grouping = asArray(state.grouping)[0],\n            value = asArray(state.value)[0];\n\n        if (!value || !category) return;\n\n        var q = babbageCtrl.getQuery();\n        q.aggregates = [value];\n        q.drilldown = [category];\n        if (grouping) {\n          q.drilldown.push(grouping);\n        }\n\n        var order = [];\n        for (var i in q.order) {\n          var o = q.order[i];\n          if ([value, category].indexOf(o.ref) != -1) {\n            order.push(o);\n          }\n        }\n        if (!order.length) {\n          order = [{ref: value, direction: 'desc'}];\n        }\n        if (grouping && order[0] && order[0].ref != grouping) {\n          order.unshift({ref: grouping, direction: 'asc'});\n        }\n\n        q.order = order;\n        q.page = 0;\n        q.pagesize = 10000;\n\n        var dfd = $http.get(babbageCtrl.getApiUrl('aggregate'),\n                            babbageCtrl.queryParams(q));\n        dfd.then(function(res) {\n          queryResult(res.data, q, model, state, category, grouping, value);\n        });\n      };\n\n      var queryResult = function(data, q, model, state, category, grouping, value) {\n        var wrapper = element.querySelectorAll('.chart-babbage')[0],\n            size = babbageCtrl.size(wrapper, function(w) {\n              return w * 0.6;\n            }),\n            colors = ngBabbageGlobals.colorScale.copy(),\n            columns = generateColumns(data.cells, category, grouping, value),\n            names = getNames(model),\n            groups = [], types = {},\n            chartType = scope.chartType;\n\n        if (grouping && chartType == 'line') {\n          chartType = 'area';\n        }\n\n        for (var i in columns) {\n          if (i > 0) {\n            if (grouping) {\n              key = randomKey();\n              names[key] = columns[i][0];\n              columns[i][0] = key;\n              groups.push(key);\n            } else {\n              groups.push(columns[i][0]);\n            }\n            types[columns[i][0]] = chartType;\n          }\n        }\n\n        d3.select(wrapper)\n          .style(\"width\", size.width + \"px\")\n          .style(\"height\", size.height + \"px\");\n\n        var chart = c3.generate({\n          bindto: wrapper,\n          data: {\n              columns: columns,\n              names: names,\n              color: function(color, d) {\n                var c = d.id || d;\n                if (chartType == 'bar' && !grouping) {\n                  c = d.index;\n                };\n                return colors(c);\n              },\n              order: null,\n              x: category,\n              groups: [groups],\n              types: types\n          },\n          point: {\n            show: false\n          },\n          grid: {\n            focus: {\n              show: false\n            }\n          },\n          axis: {\n              x: {\n                  type: 'category',\n                  tick: {\n                    culling: true,\n                    fit: true\n                  }\n              },\n              y : {\n                 tick: {\n                     format: ngBabbageGlobals.numberFormat,\n                     culling: true,\n                     fit: true\n                 },\n                 lines: [{value:0}]\n             }\n          }\n        });\n\n        scope.queryLoaded = true;\n        scope.cutoffWarning = data.total_cell_count > q.pagesize;\n        scope.cutoff = q.pagesize;\n      };\n\n      var unsubscribe = babbageCtrl.subscribe(function(event, model, state) {\n        query(model, state);\n      });\n      scope.$on('$destroy', unsubscribe);\n\n      var queryModel = {\n        value: {\n          label: 'Value',\n          addLabel: 'set height',\n          types: ['aggregates'],\n          defaults: [],\n          sortId: 1,\n          multiple: false\n        },\n        grouping: {\n          label: 'Grouping (opt)',\n          addLabel: 'select',\n          types: ['attributes'],\n          defaults: [],\n          sortId: 2,\n          remove: true,\n          multiple: false\n        }\n      };\n\n      if (scope.chartType == 'line') {\n        queryModel.category = {\n          label: 'Series',\n          addLabel: 'set series',\n          types: ['attributes'],\n          defaults: [],\n          sortId: 0,\n          multiple: false\n        };\n      }\n\n      if (scope.chartType == 'bar') {\n        queryModel.category = {\n          label: 'Categories',\n          addLabel: 'set bars',\n          types: ['attributes'],\n          defaults: [],\n          sortId: 0,\n          multiple: false\n        };\n      }\n\n      babbageCtrl.init(queryModel);\n    }\n  }\n}]);\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/chart.js\n **/","var VAL_KEY = '@@@@',\n    POS_KEY = '!@!@'\n\nngBabbage.directive('babbageCrosstab', ['$rootScope', '$http', function($rootScope, $http) {\n  return {\n  restrict: 'EA',\n  require: '^babbage',\n  scope: {\n    drilldown: '='\n  },\n  templateUrl: 'babbage-templates/crosstab.html',\n  link: function(scope, element, attrs, babbageCtrl) {\n    scope.queryLoaded = false;\n    scope.columns = [];\n    scope.rows = [];\n    scope.table = [];\n\n    var query = function(model, state) {\n      state.rows = asArray(state.rows);\n      state.columns = asArray(state.columns);\n      state.aggregates = asArray(state.aggregates);\n      // TODO: handle a case in which both sets contain the same\n      // ref.\n\n      var q = babbageCtrl.getQuery();\n      q.aggregates = q.aggregates.concat(state.aggregates);\n      if (!q.aggregates.length) {\n        q.aggregates = defaultAggregates(model);\n      }\n      q.drilldown = q.drilldown.concat(state.rows);\n      q.drilldown = q.drilldown.concat(state.columns);\n      q.page = 0;\n      q.pagesize = q.pagesize * 10000;\n\n      q.order = asArray(q.order);\n      var drilldowns = state.rows.concat(state.columns),\n          refs = drilldowns.concat(q.aggregates);\n      for (var i in drilldowns) {\n        var dd = drilldowns[i];\n        if (!babbageCtrl.getSort(dd).direction) {\n          if (q.order.indexOf(dd) == -1) {\n            q.order.push({ref: dd});\n          }\n        }\n      }\n      var order = [];\n      for (var i in q.order) {\n        var o = q.order[i];\n        if (refs.indexOf(o.ref) != -1) {\n          order.push(o);\n        }\n      }\n      q.order = order;\n\n      var dfd = $http.get(babbageCtrl.getApiUrl('aggregate'),\n                          babbageCtrl.queryParams(q));\n      dfd.then(function(res) {\n        queryResult(res.data, q, model, state);\n      });\n    };\n\n    var queryResult = function(data, q, model, state) {\n      state.rows = asArray(state.rows);\n      state.columns = asArray(state.columns);\n\n      var aggregates = data.aggregates.map(function(agg) {\n        return model.aggregates[agg];\n      });\n\n      // following code inspired by:\n      // https://github.com/DataBrewery/babbage/blob/master/babbage/formatters.py#L218\n      var matrix = {}, table = [],\n          row_headers = [], column_headers = [],\n          row_keys = [], column_keys = [];\n\n      for (var i in data.cells) {\n        var pickValue = function(k) { return cell[k]; },\n            pickRefs = function(k) { return cell[model.refKeys[k]] + cell[k]; };\n\n        var cell = data.cells[i],\n            row_values = state.rows.map(pickValue),\n            row_set = state.rows.map(pickRefs).join(VAL_KEY),\n            all_column_values = state.columns.map(pickValue),\n            all_column_set = state.columns.map(pickRefs);\n\n        for (var k in aggregates) {\n          var agg = aggregates[k],\n              label = agg.label || agg.name,\n              column_values = all_column_values.concat([label]);\n              column_set = all_column_set.concat([label]).join(VAL_KEY)\n\n          if (row_keys.indexOf(row_set) == -1) {\n            row_keys.push(row_set);\n            row_values.key = row_set;\n            row_headers.push(row_values);\n          }\n\n          if (column_keys.indexOf(column_set) == -1) {\n            column_keys.push(column_set);\n            column_headers.push(column_values);\n          }\n\n          var key = [row_set, column_set].join(POS_KEY);\n          matrix[key] = cell[agg.ref];\n        }\n      }\n\n      for (var i in row_keys) {\n        var row_key = row_keys[i];\n        var row = [];\n        for (var j in column_keys) {\n          var column_key = column_keys[j];\n          var key = [row_key, column_key].join(POS_KEY);\n          row.push(matrix[key] || data.aggregates.map(function(a) { return undefined; }));\n        }\n        table.push(row);\n      }\n\n      scope.rows = row_headers;\n      scope.columns = column_headers;\n      scope.table = table;\n      scope.queryLoaded = true;\n    };\n\n\n    var unsubscribe = babbageCtrl.subscribe(function(event, model, state) {\n      query(model, state);\n    });\n    scope.$on('$destroy', unsubscribe);\n\n    var defaultAggregates = function(model) {\n      var aggs = [];\n      for (var i in model.aggregates) {\n        var agg = model.aggregates[i];\n        aggs.push(agg.ref);\n      }\n      return aggs;\n    };\n\n    // console.log('crosstab init');\n    babbageCtrl.init({\n      columns: {\n        label: 'Columns',\n        addLabel: 'add column',\n        types: ['attributes'],\n        defaults: [],\n        sortId: 0,\n        multiple: true\n      },\n      rows: {\n        label: 'Rows',\n        addLabel: 'add row',\n        types: ['attributes'],\n        defaults: [],\n        sortId: 1,\n        multiple: true\n      },\n      aggregates: {\n        label: 'Values',\n        addLabel: 'add value',\n        types: ['aggregates'],\n        defaults: defaultAggregates,\n        sortId: 2,\n        multiple: true\n      },\n\n    });\n  }\n  };\n}]);\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/crosstab.js\n **/","\nngBabbage.directive('babbageFacts', ['$rootScope', '$http', '$q', function($rootScope, $http, $q) {\n  return {\n  restrict: 'EA',\n  require: '^babbage',\n  scope: {\n    drilldown: '='\n  },\n  templateUrl: 'babbage-templates/facts.html',\n  link: function(scope, element, attrs, babbageCtrl) {\n    scope.page = 0;\n    scope.data = [];\n    scope.columns = [];\n    scope.pagerCtx = {};\n    scope.getSort = babbageCtrl.getSort;\n    scope.pushSort = babbageCtrl.pushSort;\n\n    var query = function(model, state) {\n      var q = babbageCtrl.getQuery();\n      q.fields = asArray(state.fields);\n      if (q.fields.length == 0) {\n        q.fields = defaultFields(model);\n      }\n\n      var order = [];\n      for (var i in q.order) {\n        var o = q.order[i];\n        if (q.fields.indexOf(o.ref) != -1) {\n          order.push(o);\n        }\n      }\n      q.order = order;\n\n      var aq = angular.copy(q);\n      aq.drilldown = aq.fields = [];\n      aq.page = 0;\n      var dfd = $http.get(babbageCtrl.getApiUrl('facts'),\n                          babbageCtrl.queryParams(q));\n      dfd.then(function(res) {\n        queryResult(res.data, q, state, model);\n      });\n    };\n\n    var queryResult = function(data, q, state, model) {\n      if (!data.data.length) {\n        scope.columns = [];\n        scope.data = [];\n        scope.pagerCtx = {};\n        return;\n      };\n\n      var columns = [],\n          prev = null,\n          prev_idx = 0;\n\n      for (var i in data.fields) {\n        var ref = data.fields[i],\n            column = model.refs[ref],\n            header = column.dimension ? column.dimension : column;\n\n        if (prev && header.name == prev) {\n          columns[prev_idx].span += 1;\n          column.span = 0;\n        } else {\n          column.span = 1;\n          column.label = column.label || column.name;\n          column.header = header.label || header.name;\n          column.hide = column.hideLabel;\n          prev = header.name;\n          prev_idx = columns.length;\n        }\n        columns.push(column);\n      }\n      scope.columns = columns;\n      scope.data = data.data;\n      scope.pagerCtx = {\n        page: q.page,\n        pagesize: q.pagesize,\n        total: data.total_fact_count\n      }\n    };\n\n    var defaultFields = function(model) {\n      var defaults = [];\n      for (var i in model.measures) {\n        var mea = model.measures[i];\n        defaults.push(mea.ref);\n      }\n      for (var i in model.dimensions) {\n        var dim = model.dimensions[i];\n        for (var k in dim.attributes) {\n          var attr = dim.attributes[k];\n          if (k == dim.label_attribute) {\n            defaults.push(attr.ref);\n          }\n        }\n      }\n      return defaults;\n    };\n\n    var unsubscribe = babbageCtrl.subscribe(function(event, model, state) {\n      query(model, state);\n    });\n    scope.$on('$destroy', unsubscribe);\n\n    // console.log('facts init');\n    babbageCtrl.init({\n      fields: {\n        label: 'Columns',\n        addLabel: 'add column',\n        types: ['attributes', 'measures'],\n        defaults: defaultFields,\n        sortId: 0,\n        multiple: true\n      }\n    });\n  }\n  };\n}]);\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/facts.js\n **/","\nngBabbage.directive('babbagePager', ['$timeout', '$location', function ($timeout, $location) {\n  return {\n    restrict: 'E',\n    require: '^babbage',\n    scope: {\n      'context': '='\n    },\n    templateUrl: 'babbage-templates/pager.html',\n    link: function (scope, element, attrs, babbageCtrl) {\n      scope.showPager = false;\n      scope.hasPrev = false;\n      scope.hasNext = false;\n      scope.pages = [];\n      scope.cur = 0;\n      scope.num = 0;\n\n      scope.$watch('context', function(e) {\n        if (!scope.context || scope.context.total <= scope.context.pagesize) {\n          return;\n        }\n        scope.current = parseInt(scope.context.page, 10) || 0;\n        scope.num = Math.ceil(scope.context.total / scope.context.pagesize)\n        var pages = [],\n          num = scope.num,\n          range = 3,\n          low = scope.current - range,\n          high = scope.current + range;\n\n        if (low < 0) {\n          low = 0;\n          high = Math.min((2*range)+1, num);\n        }\n        if (high > num) {\n          high = num;\n          low = Math.max(1, num - (2*range)+1);\n        }\n\n        for (var page = low; page <= high; page++) {\n          // var offset = (page - 1) * scope.context.pagesize;\n          pages.push({\n            page: page,\n            current: page == scope.current,\n            //offset: offset\n          });\n        }\n        scope.hasPrev = scope.current > 0;\n        scope.hasNext = scope.current < num;\n        scope.showPager = num > 1;\n        scope.pages = pages;\n      });\n\n      scope.setPage = function(page) {\n        if (page >= 0 && page <= scope.num) {\n          var state = babbageCtrl.getState();\n          state.page = page;\n          babbageCtrl.setState(state);\n        }\n      }\n    }\n  };\n}]);\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/pager.js\n **/","\nngBabbage.directive('babbagePanel', ['$rootScope', 'slugifyFilter', function($rootScope, slugifyFilter) {\n  return {\n    restrict: 'EA',\n    require: '^babbage',\n    scope: {\n    },\n    templateUrl: 'babbage-templates/panel.html',\n    link: function($scope, $element, attrs, babbageCtrl) {\n      var model = null;\n\n      $scope.state = {};\n      $scope.axes = [];\n      $scope.filterAttributes = [];\n      $scope.filters = [];\n      $scope.getSort = babbageCtrl.getSort;\n      $scope.pushSort = babbageCtrl.pushSort;\n      $scope.embedLink = null;\n\n      var update = function() {\n        babbageCtrl.setState($scope.state);\n      };\n\n      $scope.add = function(axis, ref) {\n        if (axis.selected.indexOf(ref) == -1) {\n          if (axis.multiple) {\n            axis.selected.push(ref);\n          } else {\n            if (axis.selected.length) {\n              $scope.state.order = babbageCtrl.removeSorts(axis.selected[0]);\n            }\n            axis.selected = [ref];\n          }\n          $scope.state[axis.name] = axis.selected;\n          update();\n        }\n      };\n\n      $scope.remove = function(axis, ref) {\n        var i = axis.selected.indexOf(ref);\n        if (i != -1) {\n          axis.selected.splice(i, 1);\n          $scope.state[axis.name] = axis.selected;\n          $scope.state.order = babbageCtrl.removeSorts(ref);\n          update();\n        }\n      };\n\n      var makeOptions = function() {\n        var options = [];\n        for (var di in model.dimensions) {\n          var dim = model.dimensions[di];\n          for (var ai in dim.attributes) {\n            var attr = angular.copy(dim.attributes[ai]);\n            attr.dimension = dim;\n            attr.type = 'attributes';\n            if (slugifyFilter(dim.label) != slugifyFilter(attr.label)) {\n              attr.subLabel = '' + attr.label;\n            }\n            attr.sortKey = '0' + dim.label + attr.label;\n            attr.label = dim.label;\n            options.push(attr);\n          }\n        }\n\n        for (var ai in model.aggregates) {\n          var agg = model.aggregates[ai];\n          agg.type = 'aggregates';\n          agg.sortKey = '1' + ai;\n          options.push(agg);\n        }\n\n        for (var mi in model.measures) {\n          var mea = model.measures[mi];\n          mea.type = 'measures';\n          mea.sortKey = '2' + mi;\n          options.push(mea);\n        }\n\n        return options;\n      }\n\n      var sortOptions = function(a, b) {\n        return a.label.localeCompare(b.label);\n      }\n\n      var makeAxes = function(state, options) {\n        var axes = [];\n        if (!babbageCtrl.queryModel) return [];\n\n        for (var name in babbageCtrl.queryModel) {\n          var axis = babbageCtrl.queryModel[name];\n          axis.name = name;\n          if (!angular.isDefined(axis.remove)) {\n            axis.remove = axis.multiple;\n          }\n          axis.sortId = axis.sortId || 1;\n          axis.available = [];\n          axis.active = [];\n\n          axis.selected = asArray(state[name]);\n          if (!axis.selected.length) {\n            if (angular.isFunction(axis.defaults)) {\n              axis.selected = axis.defaults(model);\n            } else {\n              axis.selected = asArray(axis.defaults);\n            }\n          }\n          axis.available = axis.available.sort(sortOptions);\n          axis.active = axis.active.sort(sortOptions);\n\n          for (var i in options) {\n            var opt = options[i];\n            if (axis.selected.indexOf(opt.ref) != -1) {\n              axis.active.push(opt);\n            } else if (axis.types.indexOf(opt.type) != -1) {\n              axis.available.push(opt);\n            }\n          }\n          axes.push(axis);\n        }\n\n        return axes.sort(function(a, b) {\n          return a.sortId - b.sortId;\n        });\n      };\n\n      var makeFilterAttributes = function(options) {\n        var filters = [];\n        for (var i in options) {\n          var opt = options[i];\n          if (opt.type == 'attributes' && opt.dimension.cardinality_class != 'high') {\n            if (opt.dimension.label_ref == opt.ref) {\n              filters.push(opt);\n            }\n          }\n        }\n        return filters.sort(sortOptions);\n      };\n\n      var getAttributeByRef = function(ref) {\n        for (var i in $scope.filterAttributes) {\n          var attr = $scope.filterAttributes[i];\n          if (attr.ref == ref) {\n            return attr;\n          }\n        }\n      };\n\n      var loadFilters = function(state) {\n        var cuts = asArray(state.cut);\n        for (var i in cuts) {\n          var cut = cuts[i];\n          if (cut.indexOf(':') != -1) {\n            var ref = cut.split(':', 1)[0],\n                values = cut.slice(ref.length + 1).split(';');\n            for (var j in values) {\n              $scope.addFilter(getAttributeByRef(ref), values[j]);\n            }\n          }\n        }\n      };\n\n      $scope.addFilter = function(attr, value) {\n        babbageCtrl.getDimensionMembers(attr.ref).then(function(res) {\n          $scope.filters.push({\n            ref: attr.ref,\n            attr: attr,\n            value: value,\n            values: res.data.data.map(function(e) {\n              return e[attr.ref];\n            })\n          });\n        });\n      };\n\n      $scope.removeFilter = function(filter) {\n        var idx = $scope.filters.indexOf(filter);\n        if (idx != -1) {\n          $scope.filters.splice(idx, 1);\n          $scope.updateFilters();\n        }\n      };\n\n      $scope.setFilter = function(filter, item, value) {\n        $scope.updateFilters();\n      };\n\n      $scope.updateFilters = function() {\n        var filters = {};\n        for (var i in $scope.filters) {\n          var f = $scope.filters[i];\n          if (angular.isUndefined(filters[f.ref])) {\n            filters[f.ref] = [];\n          }\n          filters[f.ref].push(f.value);\n        }\n        var cuts = [];\n        for (var ref in filters) {\n          var values = filters[ref],\n              value = values.join(';')\n              cut = ref + ':' + value;\n          cuts.push(cut);\n        }\n        $scope.state.cut = cuts;\n        update();\n      };\n\n      var unsubscribe = babbageCtrl.subscribe(function(event, mdl, state) {\n        model = mdl;\n        $scope.state = state;\n\n        var options = makeOptions();\n        $scope.axes = makeAxes(state, options);\n        $scope.filterAttributes = makeFilterAttributes(options);\n        $scope.filters = [];\n        loadFilters(state);\n\n      });\n      $scope.$on('$destroy', unsubscribe);\n\n    }\n  };\n}]);\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/panel.js\n **/","\nngBabbage.directive('babbageSankey', ['$rootScope', '$http', '$document', function($rootScope, $http, $document) {\n  return {\n  restrict: 'EA',\n  require: '^babbage',\n  scope: {\n    drilldown: '='\n  },\n  templateUrl: 'babbage-templates/sankey.html',\n  link: function(scope, element, attrs, babbageCtrl) {\n    var unit = 15,\n        margin = {top: unit / 2, right: 1, bottom: 6, left: 1},\n        svg = null, group = null;\n\n    scope.queryLoaded = false;\n    scope.cutoffWarning = false;\n    scope.cutoff = 0;\n\n    var query = function(model, state) {\n      var source = asArray(state.source)[0],\n          target = asArray(state.target)[0]\n          aggregate = asArray(state.aggregate)[0],\n          aggregate = aggregate ? [aggregate] : defaultAggregate(model);\n\n      var q = babbageCtrl.getQuery();\n      q.aggregates = aggregate;\n      if (!source || !target) {\n        return;\n      }\n      q.drilldown = [source, target];\n\n      q.order = [\n        {\n          ref: aggregate,\n          direction: 'desc'\n        },\n        {\n          ref: source,\n          direction: 'asc'\n        },\n        {\n          ref: target,\n          direction: 'asc'\n        }\n      ];\n      q.page = 0;\n      q.pagesize = 2000;\n\n      scope.queryLoaded = true;\n      scope.cutoffWarning = false;\n      var dfd = $http.get(babbageCtrl.getApiUrl('aggregate'),\n                          babbageCtrl.queryParams(q));\n\n      var wrapper = element.querySelectorAll('.sankey-babbage')[0],\n          size = babbageCtrl.size(wrapper, function(w) { return w * 0.6; });\n\n      unit = Math.max(400, size.height) / 20;\n\n      if (!svg) {\n          svg = d3.select(wrapper).append(\"svg\");\n          group = svg.append(\"g\")\n              .attr(\"transform\", \"translate(\" + margin.left + \",\" + margin.top + \")\");\n      }\n\n      dfd.then(function(res) {\n        queryResult(size, res.data, q, model, state);\n      });\n    };\n\n    var queryResult = function(size, data, q, model, state) {\n      var sourceRef = asArray(state.source)[0],\n          targetRef = asArray(state.target)[0]\n          aggregateRef = asArray(state.aggregate)[0],\n          aggregateRef = aggregateRef ? [aggregateRef] : defaultAggregate(model),\n          size.height = data.cells.length * unit;\n\n      svg.attr(\"height\", size.height + margin.top + margin.bottom);\n      svg.attr(\"width\", size.width);\n\n      var graph = {nodes: [], links: []},\n          objs = {};\n\n      var sourceScale = ngBabbageGlobals.colorScale.copy(),\n          targetScale = d3.scale.ordinal().range(['#ddd', '#ccc', '#eee', '#bbb']);\n\n      data.cells.forEach(function(cell) {\n        var sourceId = cell[sourceRef],\n            targetId = cell[targetRef],\n            link = {\n              //value: Math.sqrt(cell[aggregateRef]),\n              value: cell[aggregateRef],\n              number: ngBabbageGlobals.numberFormat(cell[aggregateRef])\n            };\n\n        if (link.value == 0 || !sourceId || !targetId) {\n          return;\n        }\n        sourceId = 'source-' + sourceRef + sourceId;\n        targetId = 'target-' + targetRef + targetId;\n\n        if (!objs[sourceId]) {\n          var label = cell[model.refLabels[sourceRef]];\n          graph.nodes.push({\n            name: label,\n            color: sourceScale(sourceId)\n          });\n          objs[sourceId] = {idx: graph.nodes.length - 1};\n        }\n        link.source = objs[sourceId].idx;\n\n        if (!objs[targetId]) {\n          var label = cell[model.refLabels[targetRef]];\n          graph.nodes.push({\n            name: label,\n            color: targetScale(targetId)\n          });\n          objs[targetId] = {\n            idx: graph.nodes.length - 1\n          };\n        }\n        link.target = objs[targetId].idx;\n        graph.links.push(link);\n      });\n\n      var sankey = d3.sankey()\n         .nodeWidth(unit)\n         .nodePadding(unit * 0.6)\n         .size([size.width, size.height]);\n\n      var path = sankey.link();\n\n      sankey\n        .nodes(graph.nodes)\n        .links(graph.links)\n        .layout(32);\n\n      group.selectAll('g').remove();\n\n      var link = group.append(\"g\").selectAll(\".link\")\n          .data(graph.links)\n        .enter().append(\"path\")\n          .attr(\"class\", \"link\")\n          .attr(\"d\", path)\n          .style(\"stroke-width\", function(d) {\n            return Math.max(1, d.dy);\n          })\n          .style(\"stroke\", function(d) {\n            return d.source.color;\n          })\n          .sort(function(a, b) { return b.dy - a.dy; });\n\n      link.append(\"title\")\n          .text(function(d) { return d.source.name + \"  \" + d.target.name + \"\\n\" + d.number; });\n\n      var node = group.append(\"g\").selectAll(\".node\")\n          .data(graph.nodes)\n        .enter().append(\"g\")\n          .attr(\"class\", \"node\")\n          .attr(\"transform\", function(d) { return \"translate(\" + d.x + \",\" + d.y + \")\"; });\n\n      node.append(\"rect\")\n          .attr(\"height\", function(d) { return d.dy; })\n          .attr(\"width\", sankey.nodeWidth())\n          .style(\"fill\", function(d) { return d.color; })\n          //.style(\"stroke\", function(d) { return d3.rgb(d.color).darker(1); })\n          .style(\"stroke\", function(d) { return d.color; })\n        .append(\"title\")\n          .text(function(d) { return d.name });\n\n      node.append(\"text\")\n          .attr(\"x\", -6)\n          .attr(\"y\", function(d) { return d.dy / 2; })\n          .attr(\"dy\", \".35em\")\n          .attr(\"text-anchor\", \"end\")\n          .attr(\"transform\", null)\n          .text(function(d) { return d.name; })\n        .filter(function(d) { return d.x < size.width / 2; })\n          .attr(\"x\", 6 + sankey.nodeWidth())\n          .attr(\"text-anchor\", \"start\");\n\n      scope.cutoffWarning = data.total_cell_count > q.pagesize;\n      scope.cutoff = q.pagesize;\n    };\n\n    var unsubscribe = babbageCtrl.subscribe(function(event, model, state) {\n      query(model, state);\n    });\n    scope.$on('$destroy', unsubscribe);\n\n    var defaultAggregate = function(model) {\n      for (var i in model.aggregates) {\n        var agg = model.aggregates[i];\n        if (agg.measure) {\n          return [agg.ref];\n        }\n      }\n      return [];\n    };\n\n    babbageCtrl.init({\n      source: {\n        label: 'Source',\n        addLabel: 'set left side',\n        types: ['attributes'],\n        defaults: [],\n        sortId: 0,\n        multiple: false\n      },\n      target: {\n        label: 'Target',\n        addLabel: 'set right side',\n        types: ['attributes'],\n        defaults: [],\n        sortId: 1,\n        multiple: false\n      },\n      aggregate: {\n        label: 'Width',\n        addLabel: 'set width',\n        types: ['aggregates'],\n        defaults: defaultAggregate,\n        sortId: 2,\n        multiple: false\n      },\n\n    });\n  }\n  };\n}]);\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/sankey.js\n **/","\nngBabbage.directive('babbageTreemap', ['$rootScope', '$http', '$document', function($rootScope, $http, $document) {\n  return {\n  restrict: 'EA',\n  require: '^babbage',\n  scope: {\n    drilldown: '='\n  },\n  templateUrl: 'babbage-templates/treemap.html',\n  link: function(scope, element, attrs, babbageCtrl) {\n    var treemap = null,\n        div = null;\n\n    scope.queryLoaded = false;\n    scope.cutoffWarning = false;\n\n    var query = function(model, state) {\n      var tile = asArray(state.tile)[0],\n          area = asArray(state.area)[0],\n          area = area ? [area] : defaultArea(model);\n\n      var q = babbageCtrl.getQuery();\n      q.aggregates = area;\n      if (!tile) {\n        return;\n      }\n      q.drilldown = [tile];\n\n      var order = [];\n      for (var i in q.order) {\n        var o = q.order[i];\n        if ([tile, area].indexOf(o.ref) != -1) {\n          order.push(o);\n        }\n      }\n      if (!order.length) {\n        order = [{ref: area, direction: 'desc'}];\n      }\n\n      q.order = order;\n      q.page = 0;\n      q.pagesize = 50;\n\n      scope.cutoffWarning = false;\n      scope.queryLoaded = true;\n      var dfd = $http.get(babbageCtrl.getApiUrl('aggregate'),\n                          babbageCtrl.queryParams(q));\n\n      var wrapper = element.querySelectorAll('.treemap-babbage')[0],\n          size = babbageCtrl.size(wrapper, function(w) { return w * 0.6; });\n\n      treemap = d3.layout.treemap()\n        .size([size.width, size.height])\n        .sticky(true)\n        .sort(function(a, b) { return a[area] - b[area]; })\n        .value(function(d) { return d[area]; });\n\n      d3.select(wrapper).select(\"div\").remove();\n      div = d3.select(wrapper).append(\"div\")\n        .style(\"position\", \"relative\")\n        .style(\"width\", size.width + \"px\")\n        .style(\"height\", size.height + \"px\");\n\n      dfd.then(function(res) {\n        queryResult(res.data, q, model, state);\n      });\n    };\n\n    var queryResult = function(data, q, model, state) {\n      var tileRef = asArray(state.tile)[0],\n          areaRef = asArray(state.area)[0],\n          areaRef = areaRef ? [areaRef] : defaultArea(model);\n\n      var root = {\n        children: []\n      };\n\n      for (var i in data.cells) {\n        var cell = data.cells[i];\n        cell._area_fmt = ngBabbageGlobals.numberFormat(Math.round(cell[areaRef]));\n        cell._name = cell[tileRef];\n        cell._color = ngBabbageGlobals.colorScale(i);\n        cell._percentage = cell[areaRef] / Math.max(data.summary[areaRef], 1);\n        root.children.push(cell);\n      };\n\n      var node = div.datum(root).selectAll(\".node\")\n          .data(treemap.nodes)\n        .enter().append(\"a\")\n          .attr(\"href\", function(d){ return d.href; })\n          .attr(\"class\", \"node\")\n          .call(positionNode)\n          .style(\"background\", '#fff')\n          .html(function(d) {\n            if (d._percentage < 0.02) {\n              return '';\n            }\n            return d.children ? null : '<span class=\"amount\">' + d._area_fmt + '</span>' + d._name;\n          })\n          .on(\"mouseover\", function(d) {\n            d3.select(this).transition().duration(200)\n              .style({'background': d3.rgb(d._color).darker() });\n          })\n          .on(\"mouseout\", function(d) {\n            d3.select(this).transition().duration(500)\n              .style({'background': d._color});\n          })\n          .transition()\n          .duration(500)\n          .delay(function(d, i) { return Math.min(i * 30, 1500); })\n          .style(\"background\", function(d) { return d._color; });\n\n      scope.cutoffWarning = data.total_cell_count > q.pagesize;\n      scope.cutoff = q.pagesize;\n    };\n\n    function positionNode() {\n      this.style(\"left\", function(d) { return d.x + \"px\"; })\n          .style(\"top\", function(d) { return d.y + \"px\"; })\n          .style(\"width\", function(d) { return Math.max(0, d.dx - 1) + \"px\"; })\n          .style(\"height\", function(d) { return Math.max(0, d.dy - 1) + \"px\"; });\n    };\n\n\n    var unsubscribe = babbageCtrl.subscribe(function(event, model, state) {\n      query(model, state);\n    });\n    scope.$on('$destroy', unsubscribe);\n\n    var defaultArea = function(model) {\n      for (var i in model.aggregates) {\n        var agg = model.aggregates[i];\n        if (agg.measure) {\n          return [agg.ref];\n        }\n      }\n      return [];\n    };\n\n    babbageCtrl.init({\n      tile: {\n        label: 'Tiles',\n        addLabel: 'set breakdown',\n        types: ['attributes'],\n        defaults: [],\n        sortId: 0,\n        multiple: false\n      },\n      area: {\n        label: 'Area',\n        addLabel: 'set area',\n        types: ['aggregates'],\n        defaults: defaultArea,\n        sortId: 1,\n        multiple: false\n      },\n    });\n  }\n  };\n}]);\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/treemap.js\n **/","\nfunction asArray(obj) {\n  objs = obj ? obj : [];\n  return angular.isArray(objs) ? objs : [objs];\n}\n\nfunction randomKey() {\n  return 'X' + Math.random().toString(36).substring(7);\n}\n\n// https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/endsWith\n// suggested polyfill for safari & IE\nif (!String.prototype.endsWith) {\n  String.prototype.endsWith = function(searchString, position) {\n      var subjectString = this.toString();\n      if (position === undefined || position > subjectString.length) {\n        position = subjectString.length;\n      }\n      position -= searchString.length;\n      var lastIndex = subjectString.indexOf(searchString, position);\n      return lastIndex !== -1 && lastIndex === position;\n  };\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/util.js\n **/","\nngBabbage.directive('babbageWorkspace', ['$location', function($location) {\n  return {\n    restrict: 'EA',\n    scope: {\n      endpoint: '@',\n      cube: '@'\n    },\n    templateUrl: 'babbage-templates/workspace.html',\n    link: function(scope, element, attrs) {\n      scope.state = null;\n      scope.embedLink = null;\n\n      scope.setView = function(view) {\n        scope.view = view;\n        scope.state.view = view;\n        scope.update(scope.state);\n      };\n\n      scope.update = function(state) {\n        scope.state = state;\n        scope.view = scope.state.view || 'facts';\n        $location.search(state);\n        prepareEmbed();\n      };\n\n      var prepareEmbed = function() {\n        var qs = [],\n            opts = angular.extend({}, $location.search(), {\n              view: scope.view,\n              endpoint: scope.endpoint,\n              cube: scope.cube,\n              embed: true\n            });\n        for (var name in opts) {\n          var values = asArray(opts[name]);\n          for (var i in values) {\n            var val = encodeURIComponent(values[i]);\n            qs.push(name + '=' + val);\n          }\n        }\n        scope.embedLink = ngBabbageGlobals.embedLink + '#/?' + qs.join('&');\n      };\n\n      scope.update($location.search());\n    }\n  };\n}]);\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/workspace.js\n **/"],"sourceRoot":""}