/*! angular-cubes 2015-07-09 */
function asArray(a){return objs=a?a:[],angular.isArray(objs)?objs:[objs]}var makeSignal=function(a){return"cubes_"+Math.random().toString(36).replace(/[^a-z]+/g,"")};String.prototype.endsWith||(String.prototype.endsWith=function(a,b){var c=this.toString();(void 0===b||b>c.length)&&(b=c.length),b-=a.length;var d=c.indexOf(a,b);return-1!==d&&d===b});var ngCubes=angular.module("ngCubes",["ngCubes.templates"]),numberFormat=d3.format("0,000");ngCubes.filter("numeric",function(){return function(a){var b=parseFloat(a);return isNaN(b)?"-":numberFormat(Math.round(b))}}),ngCubes.factory("cubesApi",["$http","$q","slugifyFilter",function(a,b,c){var d={},e=function(a,b,c){var d=a.slice(),d=d.endsWith("/")?d.slice(0,d.length-1):d,d=d+"/cube/"+b+"/"+c;return d},f=function(b){return angular.isDefined(d[b])||(d[b]=a.get(b)),d[b]},g=function(a,b){return f(e(a,b,"model")).then(function(a){var b=a.data;b.refs={},b.refKeys={},b.refLabels={};for(var d in b.measures){var e=b.measures[d];e.numeric=!0,e.hideLabel=!0,b.refs[e.ref]=e}for(var f in b.dimensions){var g=b.dimensions[f];for(var h in g.levels){var i=g.levels[h];for(var j in i.attributes){var k=i.attributes[j],l=-1!=k.ref.indexOf(".");k.dimension=g,k.hideLabel=c(k.label)==c(g.label),b.refs[k.ref]=k,b.refKeys[k.ref]=l?g.name+"."+i.key:k.ref,b.refLabels[k.ref]=l?g.name+"."+i.label_attribute:k.ref}}}return b})},h=function(a,b,c){return f(e(a,b,"members/"+c))},i=function(){d={}};return{getUrl:e,getModel:g,getDimensionMembers:h,flush:i}}]),ngCubes.directive("cubes",["$http","$rootScope","$location","cubesApi",function(a,b,c,d){return{restrict:"E",transclude:!0,scope:{slicer:"@",cube:"@",state:"="},templateUrl:"angular-cubes-templates/cubes.html",controller:["$scope",function(a){var e=this,f=angular.extend({},a.state||{},c.search());e.dataUpdate=makeSignal(),e.modelUpdate=makeSignal(),e.queryModel={},e.init=function(c){e.queryModel=c,d.getModel(a.slicer,a.cube).then(function(a){b.$broadcast(e.modelUpdate,a,f)})},e.getState=function(){return f},e.setState=function(a){c.search(a)},e.getApiUrl=function(b){return d.getUrl(a.slicer,a.cube,b)},e.getDimensionMembers=function(b){return d.getDimensionMembers(a.slicer,a.cube,b)},e.getSorts=function(){var a=[],b=f.order||"",b=asArray(b.split(","));for(var c in b){var d=b[c].split(":"),e={};e.ref=d[0],e.direction=d[1]||null,a.push(e)}return a},e.getSort=function(a){var b=e.getSorts();for(var c in b)if(b[c].ref==a)return b[c];return{ref:a}},e.pushSort=function(a,b){var c=e.getSorts().filter(function(b){return b.ref!=a});c.unshift({ref:a,direction:b}),f.order=e.mergeSorts(c),e.setState(f)},e.removeSorts=function(a){var b=e.getSorts().filter(function(b){return b.ref!=a});return e.mergeSorts(b)},e.mergeSorts=function(a){var b=[];a=asArray(a);for(var c in a){var d=a[c];angular.isObject(d)&&d.ref.length&&(d.direction=d.direction||"asc",d=d.ref+":"+d.direction,b.push(d))}return b.join(",")},e.getQuery=function(){var a={drilldown:[],aggregates:[],cut:f.cut||[],page:f.page||0,pagesize:f.pagesize||30,order:e.getSorts()};return a},e.queryParams=function(a){a.order=e.mergeSorts(a.order);for(var b in a)angular.isArray(a[b])&&(-1!=["order","fields"].indexOf(b)?a[b]=a[b].join(","):a[b]=a[b].join("|")),a[b]=a[b]+"",a[b].length||delete a[b];return{params:a}}}]}}]),ngCubes.directive("cubesPager",["$timeout","$location",function(a,b){return{restrict:"E",scope:{context:"="},templateUrl:"angular-cubes-templates/pager.html",link:function(a,c,d,e){a.showPager=!1,a.hasPrev=!1,a.hasNext=!1,a.pages=[],a.cur=0,a.num=0,a.$watch("context",function(b){if(a.context&&!(a.context.total<=a.context.pagesize)){a.current=parseInt(a.context.page,10)||0,a.num=Math.ceil(a.context.total/a.context.pagesize);var c=[],d=a.num,e=3,f=a.current-e,g=a.current+e;0>f&&(f=0,g=Math.min(2*e+1,d)),g>d&&(g=d,f=Math.max(1,d-2*e+1));for(var h=f;g>=h;h++)c.push({page:h,current:h==a.current});a.hasPrev=a.current>0,a.hasNext=a.current<d,a.showPager=d>1,a.pages=c}}),a.setPage=function(c){if(c>=0&&c<=a.num){var d=b.search();d.page=c,b.search(d)}}}}}]);var VAL_KEY="@@@@",POS_KEY="!@!@";ngCubes.directive("cubesCrosstab",["$rootScope","$http",function(a,b){return{restrict:"EA",require:"^cubes",scope:{drilldown:"="},templateUrl:"angular-cubes-templates/crosstab.html",link:function(c,d,e,f){c.queryLoaded=!1,c.columns=[],c.rows=[],c.table=[];var g=function(a,c){c.rows=asArray(c.rows),c.columns=asArray(c.columns),c.aggregates=asArray(c.aggregates);var d=f.getQuery();d.aggregates=d.aggregates.concat(c.aggregates),d.aggregates.length||(d.aggregates=i(a)),d.drilldown=d.drilldown.concat(c.rows),d.drilldown=d.drilldown.concat(c.columns),d.page=0,d.pagesize=1e4*d.pagesize,d.order=asArray(d.order);var e=c.rows.concat(c.columns),g=e.concat(d.aggregates);for(var j in e){var k=e[j];f.getSort(k).direction||-1==d.order.indexOf(k)&&d.order.push({ref:k})}var l=[];for(var j in d.order){var m=d.order[j];-1!=g.indexOf(m.ref)&&l.push(m)}d.order=l;var n=b.get(f.getApiUrl("aggregate"),f.queryParams(d));n.then(function(b){h(b.data,d,a,c)})},h=function(a,b,d,e){e.rows=asArray(e.rows),e.columns=asArray(e.columns);var f=d.aggregates.filter(function(b){return-1!=a.aggregates.indexOf(b.ref)}),g={},h=[],i=[],j=[],k=[],l=[];for(var m in a.cells){var n=function(a){return p[a]},o=function(a){return p[d.refKeys[a]]+p[a]},p=a.cells[m],q=e.rows.map(n),r=e.rows.map(o).join(VAL_KEY),s=e.columns.map(n),t=e.columns.map(o);for(var u in f){var v=f[u],w=v.label||v.name,x=s.concat([w]);column_set=t.concat([w]).join(VAL_KEY),-1==k.indexOf(r)&&(k.push(r),q.key=r,i.push(q)),-1==l.indexOf(column_set)&&(l.push(column_set),j.push(x));var y=[r,column_set].join(POS_KEY);g[y]=p[v.name]}}for(var m in k){var z=k[m],A=[];for(var B in l){var C=l[B],y=[z,C].join(POS_KEY);A.push(g[y]||a.aggregates.map(function(a){return void 0}))}h.push(A)}c.rows=i,c.columns=j,c.table=h,c.queryLoaded=!0};a.$on(f.modelUpdate,function(a,b,c){g(b,c)});var i=function(a){var b=[];for(var c in a.aggregates){var d=a.aggregates[c];b.push(d.ref)}return b};f.init({columns:{label:"Columns",addLabel:"add column",types:["attributes"],defaults:[],sortId:0,multiple:!0},rows:{label:"Rows",addLabel:"add row",types:["attributes"],defaults:[],sortId:1,multiple:!0},aggregates:{label:"Values",addLabel:"add value",types:["aggregates"],defaults:i,sortId:2,multiple:!0}})}}}]),ngCubes.directive("cubesFacts",["$rootScope","$http","$q",function(a,b,c){return{restrict:"EA",require:"^cubes",scope:{drilldown:"="},templateUrl:"angular-cubes-templates/facts.html",link:function(d,e,f,g){d.page=0,d.data=[],d.columns=[],d.pagerCtx={},d.getSort=g.getSort,d.pushSort=g.pushSort;var h=function(a,d){var e=g.getQuery();e.fields=asArray(d.fields),0==e.fields.length&&(e.fields=j(a));var f=[];for(var h in e.order){var k=e.order[h];-1!=e.fields.indexOf(k.ref)&&f.push(k)}e.order=f;var l=angular.copy(e);l.drilldown=l.fields=[],l.page=0;var m=b.get(g.getApiUrl("facts"),g.queryParams(e)),n=b.get(g.getApiUrl("aggregate"),g.queryParams(l));c.all([m,n]).then(function(b){i(b[0].data,b[1].data,e,d,a)})},i=function(a,b,c,e,f){if(!a.length)return d.columns=[],d.data=[],void(d.pagerCtx={});var g=a[0],h=[];for(var i in g)h.push(i);h=h.sort();var j=[],k=null,l=0;for(var m in h){var n=h[m],o=f.refs[n],p=o.dimension?o.dimension:o;o.ref=n,p.name==k?(j[l].span+=1,o.span=0):(o.span=1,o.label=o.label||o.name,o.header=p.label||p.name,o.hide=o.hideLabel,k=p.name,l=j.length),j.push(o)}d.columns=j,d.data=a,d.pagerCtx={page:c.page,pagesize:c.pagesize,total:b.summary.fact_count}},j=function(a){var b=[];for(var c in a.measures){var d=a.measures[c];b.push(d.ref)}for(var c in a.dimensions){var e=a.dimensions[c];for(var f in e.levels){var g=e.levels[f];for(var h in g.attributes){var i=g.attributes[h];i.name==g.label_attribute&&b.push(i.ref)}}}return b};a.$on(g.modelUpdate,function(a,b,c){h(b,c)}),g.init({fields:{label:"Columns",addLabel:"add column",types:["attributes","measures"],defaults:j,sortId:0,multiple:!0}})}}}]),ngCubesCategoryColors=["#CF3D1E","#F15623","#F68B1F","#FFC60B","#DFCE21","#BCD631","#95C93D","#48B85C","#00833D","#00B48D","#60C4B1","#27C4F4","#478DCB","#3E67B1","#4251A3","#59449B","#6E3F7C","#6A246D","#8A4873","#EB0080","#EF58A0","#C05A89"],ngCubesColorScale=d3.scale.ordinal().range(ngCubesCategoryColors),ngCubes.directive("cubesTreemap",["$rootScope","$http","$document",function(a,b,c){return{restrict:"EA",require:"^cubes",scope:{drilldown:"="},templateUrl:"angular-cubes-templates/treemap.html",link:function(c,d,e,f){function g(){this.style("left",function(a){return a.x+"px"}).style("top",function(a){return a.y+"px"}).style("width",function(a){return Math.max(0,a.dx-1)+"px"}).style("height",function(a){return Math.max(0,a.dy-1)+"px"})}var h=null,i=null;c.queryLoaded=!1,c.cutoffWarning=!1;var j=function(a,e){var g=asArray(e.tile)[0],j=asArray(e.area)[0],j=j?[j]:l(a),m=f.getQuery();if(m.aggregates=j,g){m.drilldown=[g];var n=[];for(var o in m.order){var p=m.order[o];-1!=[g,j].indexOf(p.ref)&&n.push(p)}n.length||(n=[{ref:j,direction:"desc"}]),m.order=n,m.page=0,m.pagesize=50,c.cutoffWarning=!1,c.queryLoaded=!0;var q=b.get(f.getApiUrl("aggregate"),f.queryParams(m)),r=d.querySelectorAll(".treemap-cubes")[0],s=r.clientWidth,t=.6*s;h=d3.layout.treemap().size([s,t]).sticky(!0).sort(function(a,b){return a[j]-b[j]}).value(function(a){return a[j]}),i=d3.select(r).append("div").style("position","relative").style("width",s+"px").style("height",t+"px"),q.then(function(b){k(b.data,m,a,e)})}},k=function(a,b,d,e){var f=asArray(e.tile)[0],j=asArray(e.area)[0],j=j?[j]:l(d),k={children:[]};for(var m in a.cells){var n=a.cells[m];n._area_fmt=numberFormat(Math.round(n[j])),n._name=n[f],n._color=ngCubesColorScale(m),n._percentage=n[j]/Math.max(a.summary[j],1),k.children.push(n)}i.datum(k).selectAll(".node").data(h.nodes).enter().append("a").attr("href",function(a){return a.href}).attr("class","node").call(g).style("background","#fff").html(function(a){return a._percentage<.02?"":a.children?null:'<span class="amount">'+a._area_fmt+"</span>"+a._name}).on("mouseover",function(a){d3.select(this).transition().duration(200).style({background:d3.rgb(a._color).darker()})}).on("mouseout",function(a){d3.select(this).transition().duration(500).style({background:a._color})}).transition().duration(500).delay(function(a,b){return Math.min(30*b,1500)}).style("background",function(a){return a._color});c.cutoffWarning=a.total_cell_count>b.pagesize,c.cutoff=b.pagesize};a.$on(f.modelUpdate,function(a,b,c){j(b,c)});var l=function(a){for(var b in a.aggregates){var c=a.aggregates[b];if(c.measure)return[c.ref]}return[]};f.init({tile:{label:"Tiles",addLabel:"set breakdown",types:["attributes"],defaults:[],sortId:0,multiple:!1},area:{label:"Area",addLabel:"set area",types:["aggregates"],defaults:l,sortId:1,multiple:!1}})}}}]),ngCubes.directive("cubesSankey",["$rootScope","$http","$document",function(a,b,c){return{restrict:"EA",require:"^cubes",scope:{drilldown:"="},templateUrl:"angular-cubes-templates/sankey.html",link:function(c,d,e,f){var g=15,h={top:g/2,right:1,bottom:6,left:1},i=null,j=null;c.queryLoaded=!1,c.cutoffWarning=!1,c.cutoff=0;var k=function(a,e){var g=asArray(e.source)[0],k=asArray(e.target)[0];aggregate=asArray(e.aggregate)[0],aggregate=aggregate?[aggregate]:m(a);var n=f.getQuery();if(n.aggregates=aggregate,g&&k){n.drilldown=[g,k],n.order=[{ref:aggregate,direction:"desc"},{ref:g,direction:"asc"},{ref:k,direction:"asc"}],n.page=0,n.pagesize=2e3,c.queryLoaded=!0,c.cutoffWarning=!1;var o=b.get(f.getApiUrl("aggregate"),f.queryParams(n)),p=d.querySelectorAll(".sankey-cubes")[0],q=p.clientWidth;i||(i=d3.select(p).append("svg").attr("width",q+h.left+h.right).attr("height",h.top+h.bottom),j=i.append("g").attr("transform","translate("+h.left+","+h.top+")")),o.then(function(b){l(q,b.data,n,a,e)})}},l=function(a,b,d,e,f){var k=asArray(f.source)[0],l=asArray(f.target)[0];aggregateRef=asArray(f.aggregate)[0],aggregateRef=aggregateRef?[aggregateRef]:m(e),height=b.cells.length*g*.6,i.attr("height",height+h.top+h.bottom);var n={nodes:[],links:[]},o={};b.cells.forEach(function(a){var b=a[k],c=a[l],d={value:Math.sqrt(a[aggregateRef]),number:numberFormat(a[aggregateRef])};if(0!=d.value&&b&&c){if(!o[b]){var f=a[e.refLabels[k]];n.nodes.push({name:f,color:ngCubesColorScale(b)}),o[b]={idx:n.nodes.length-1}}if(d.source=o[b].idx,!o[c]){var f=a[e.refLabels[l]];n.nodes.push({name:f,color:ngCubesColorScale(c)}),o[c]={idx:n.nodes.length-1}}d.target=o[c].idx,n.links.push(d)}});var p=d3.sankey().nodeWidth(g).nodePadding(.6*g).size([a,height]),q=p.link();p.nodes(n.nodes).links(n.links).layout(32);var r=j.append("g").selectAll(".link").data(n.links).enter().append("path").attr("class","link").attr("d",q).style("stroke-width",function(a){return Math.max(1,a.dy)}).style("stroke",function(a){return a.source.color}).sort(function(a,b){return b.dy-a.dy});r.append("title").text(function(a){return a.source.name+" â†’ "+a.target.name+"\n"+a.number});var s=j.append("g").selectAll(".node").data(n.nodes).enter().append("g").attr("class","node").attr("transform",function(a){return"translate("+a.x+","+a.y+")"});s.append("rect").attr("height",function(a){return a.dy}).attr("width",p.nodeWidth()).style("fill",function(a){return a.color}).style("stroke",function(a){return d3.rgb(a.color).darker(1)}).append("title").text(function(a){return a.name}),s.append("text").attr("x",-6).attr("y",function(a){return a.dy/2}).attr("dy",".35em").attr("text-anchor","end").attr("transform",null).text(function(a){return a.name}).filter(function(b){return b.x<a/2}).attr("x",6+p.nodeWidth()).attr("text-anchor","start"),c.cutoffWarning=b.total_cell_count>d.pagesize,c.cutoff=d.pagesize};a.$on(f.modelUpdate,function(a,b,c){k(b,c)});var m=function(a){for(var b in a.aggregates){var c=a.aggregates[b];if(c.measure)return[c.ref]}return[]};f.init({source:{label:"Source",addLabel:"set left side",types:["attributes"],defaults:[],sortId:0,multiple:!1},target:{label:"Target",addLabel:"set right side",types:["attributes"],defaults:[],sortId:1,multiple:!1},aggregate:{label:"Width",addLabel:"set width",types:["aggregates"],defaults:m,sortId:2,multiple:!1}})}}}]),ngCubes.directive("cubesPanel",["$rootScope","slugifyFilter",function(a,b){return{restrict:"EA",require:"^cubes",scope:{},templateUrl:"angular-cubes-templates/panel.html",link:function(c,d,e,f){var g=null;c.state={},c.axes=[],c.filterAttributes=[],c.filters=[],c.getSort=f.getSort,c.pushSort=f.pushSort;var h=function(){f.setState(c.state)};c.add=function(a,b){-1==a.selected.indexOf(b)&&(a.multiple?a.selected.push(b):(a.selected.length&&(c.state.order=f.removeSorts(a.selected[0])),a.selected=[b]),c.state[a.name]=a.selected,h())},c.remove=function(a,b){var d=a.selected.indexOf(b);-1!=d&&(a.selected.splice(d,1),c.state[a.name]=a.selected,c.state.order=f.removeSorts(b),h())};var i=function(){var a=[];for(var c in g.dimensions){var d=g.dimensions[c];for(var e in d.levels){var f=d.levels[e];for(var h in f.attributes){var i=angular.copy(f.attributes[h]);i.dimension=d,i.level=f,i.type="attributes",b(d.label)!=b(i.label)&&(i.subLabel=""+i.label),i.sortKey="0"+d.label+i.label,i.label=d.label,i.cardinality=f.cardinality,a.push(i)}}}for(var h in g.aggregates){var j=g.aggregates[h];j.type="aggregates",j.sortKey="1"+j.name,a.push(j)}for(var k in g.measures){var l=g.measures[k];l.type="measures",l.sortKey="2"+l.name,a.push(l)}return a},j=function(a,b){return a.label.localeCompare(b.label)},k=function(a,b){var c=[];if(!f.queryModel)return[];for(var d in f.queryModel){var e=f.queryModel[d];e.name=d,e.sortId=e.sortId||1,e.available=[],e.active=[],e.selected=asArray(a[d]),e.selected.length||(angular.isFunction(e.defaults)?e.selected=e.defaults(g):e.selected=asArray(e.defaults)),e.available=e.available.sort(j),e.active=e.active.sort(j);for(var h in b){var i=b[h];-1!=e.selected.indexOf(i.ref)?e.active.push(i):-1!=e.types.indexOf(i.type)&&e.available.push(i)}c.push(e)}return c.sort(function(a,b){return a.sortId-b.sortId})},l=function(a){var b=[];for(var c in a){var d=a[c];"attributes"==d.type&&"high"!=d.cardinality&&d.level.label_attribute==d.name&&b.push(d)}return b.sort(j)},m=function(a){return a.split(".",1)},n=function(a,b){return b.data.data.map(function(b){return{label:b[a],value:b[g.refKeys[a]]}})},o=function(a){for(var b in c.filterAttributes){var d=c.filterAttributes[b];if(d.ref==a)return d}},p=function(a){var b=asArray(a.cut);for(var d in b){var e=b[d];if(-1!=e.indexOf(":")){var f=e.split(":",1)[0],g=e.slice(f.length+1).split(";");for(var h in g)c.addFilter(o(f),g[h])}}};c.addFilter=function(a,b){f.getDimensionMembers(m(a.ref)).then(function(d){c.filters.push({ref:a.ref,attr:a,value:b,values:n(a.ref,d)})})},c.removeFilter=function(a){var b=c.filters.indexOf(a);-1!=b&&(c.filters.splice(b,1),c.updateFilters())},c.setFilter=function(a,b,d){c.updateFilters()},c.updateFilters=function(){var a={};for(var b in c.filters){var d=c.filters[b];angular.isUndefined(a[d.ref])&&(a[d.ref]=[]),a[d.ref].push(d.value)}var e=[];for(var f in a){var g=a[f],i=g.join(";");cut=f+":"+i,e.push(cut)}c.state.cut=e,h()},a.$on(f.modelUpdate,function(a,b,d){g=b,c.state=d;var e=i();c.axes=k(d,e),c.filterAttributes=l(e),c.filters=[],p(d)})}}}]),ngCubes.directive("cubesWorkspace",["$location",function(a){return{restrict:"EA",scope:{slicer:"@",cube:"@"},templateUrl:"angular-cubes-templates/workspace.html",link:function(b,c,d){var e=function(){var a;return b.visualizations.some(function(c){return c.view==b.view?(a=c,!0):void 0}),a};b.state={},b.visualizationHead={name:"Visulization",icon:"fa-eye",visible:!1},b.visualizations=[{name:"Treemap",icon:"fa-th-large",view:"treemap",visible:!0},{name:"Barchart",icon:"fa-bar-chart",view:"barchart",visible:!0},{name:"Flow diagram",icon:"fa-random",view:"sankey",visible:!0}],b.view=a.search().view||"facts",b.activeVisualization=e()||b.visualizationHead,b.$watch("view",function(a){a&&(b.activeVisualization=e()||b.visualizationHead)}),b.setView=function(b){var c=a.search();c.view=b,a.search(c)},b.status={isopen:!1},b.toggleDropdown=function(a,c){a.preventDefault(),a.stopPropagation(),b.status.isopen=!b.status.isopen,b.setView(c)}}}}]),angular.module("ngCubes.templates",["angular-cubes-templates/barchart.html","angular-cubes-templates/crosstab.html","angular-cubes-templates/cubes.html","angular-cubes-templates/facts.html","angular-cubes-templates/pager.html","angular-cubes-templates/panel.html","angular-cubes-templates/sankey.html","angular-cubes-templates/treemap.html","angular-cubes-templates/workspace.html"]),angular.module("angular-cubes-templates/barchart.html",[]).run(["$templateCache",function(a){a.put("angular-cubes-templates/barchart.html",'<div class="table-cubes" ng-hide="queryLoaded">\n  <div class="alert alert-info">\n    <strong>You have not selected any data.</strong> Please choose a breakdown for\n    your treemap.\n  </div>\n</div>\n<div class="barchart-cubes">\n')}]),angular.module("angular-cubes-templates/crosstab.html",[]).run(["$templateCache",function(a){a.put("angular-cubes-templates/crosstab.html",'<div class="table-cubes" ng-show="rows.length">\n  <table class="table table-bordered table-condensed">\n    <thead>\n      <tr ng-repeat="x in columns[0]">\n        <th ng-repeat="r in rows[0]"></th>\n        <th ng-repeat="c in columns">\n          {{c[$parent.$index]}}\n        </th>\n      </tr>\n    </thead>\n    <tbody>\n      <tr ng-repeat="row in rows">\n        <th ng-repeat="r in row">\n          {{r}}\n        </th>\n        <td ng-repeat="val in table[$index] track by $index" class="numeric">\n          {{val | numeric}}\n        </td>\n      </tr>\n    </tbody>\n  </table>\n</div>\n\n<div class="table-cubes" ng-hide="rows.length || !queryLoaded">\n  <div class="alert alert-info">\n    <strong>You have not selected any data.</strong> Please choose a set of rows \n    and columns to generate a cross-table.\n  </div>\n</div>\n')}]),angular.module("angular-cubes-templates/cubes.html",[]).run(["$templateCache",function(a){a.put("angular-cubes-templates/cubes.html",'<div class="cubes-frame" ng-transclude>\n</div>\n')}]),angular.module("angular-cubes-templates/facts.html",[]).run(["$templateCache",function(a){a.put("angular-cubes-templates/facts.html",'<div class="table-cubes" ng-show="data">\n  <table class="table table-bordered table-striped table-condensed">\n    <thead>\n      <tr>\n        <th ng-repeat-start="c in columns" class="title">\n          {{ c.header }}\n          <span class="sublabel" ng-hide="c.hide">{{ c.label }}</span>\n        </th>\n        <th ng-repeat-end class="operations" ng-switch="getSort(c.ref).direction">\n          <span ng-switch-when="desc" ng-click="pushSort(c.ref, \'asc\')" class="ng-link">\n            <i class="fa fa-sort-desc"></i>\n          </span>\n          <span ng-switch-when="asc" ng-click="pushSort(c.ref, \'desc\')" class="ng-link">\n            <i class="fa fa-sort-asc"></i>\n          </span>\n          <span ng-switch-default ng-click="pushSort(c.ref, \'desc\')" class="ng-link">\n            <i class="fa fa-sort"></i>\n          </span>\n        </th>\n      </tr>\n    </thead>\n    <tbody>\n      <tr ng-repeat="row in data">\n        <td ng-repeat="c in columns" ng-class="{\'numeric\': c.numeric}" class="simple"\n          colspan="2">\n          <span ng-if="c.numeric">\n            {{ row[c.ref] | numeric }}\n          </span>\n          <span ng-if="!c.numeric">\n            {{ row[c.ref] }}\n          </span>\n        </td>\n      </tr>\n    </tbody>\n  </table>\n</div>\n<cubes-pager context="pagerCtx"></cubes-pager>\n')}]),angular.module("angular-cubes-templates/pager.html",[]).run(["$templateCache",function(a){a.put("angular-cubes-templates/pager.html",'<ul ng-show="showPager" class="pagination pagination-sm">\n  <li ng-class="{\'disabled\': !hasPrev}">\n    <a class="ng-link" ng-click="setPage(current - 1)">&laquo;</a>\n  </li>\n  <li ng-repeat="page in pages" ng-class="{\'active\': page.current}">\n    <a class="ng-link" ng-click="setPage(page.page)">{{page.page + 1}}</a>\n  </li>\n  <li ng-class="{\'disabled\': !hasNext}">\n    <a class="ng-link" ng-click="setPage(current + 1)">&raquo;</a>\n  </li>\n</ul>\n')}]),angular.module("angular-cubes-templates/panel.html",[]).run(["$templateCache",function(a){a.put("angular-cubes-templates/panel.html",'<div class="panel panel-default" ng-repeat="axis in axes">\n  <div class="panel-heading">\n    <strong>{{axis.label}}</strong>\n\n    <div class="btn-group" dropdown ng-show="axis.available.length">\n      &mdash;\n      <a dropdown-toggle class="ng-link">{{axis.addLabel}}</a>\n      <ul class="dropdown-menu" role="menu">\n        <li ng-repeat="opt in axis.available">\n          <a ng-click="add(axis, opt.ref)">\n            <strong>{{opt.label}}</strong>\n            {{opt.subLabel}}\n          </a>\n        </li>\n      </ul>\n    </div>\n  </div>\n  <table class="table">\n    <tr ng-repeat="opt in axis.active">\n      <td colspan="2">\n        <div class="pull-right">\n          <span ng-switch="getSort(opt.ref).direction">\n            <a ng-switch-when="desc" ng-click="pushSort(opt.ref, \'asc\')" class="ng-link ng-icon">\n              <i class="fa fa-sort-amount-desc"></i></a>\n            <a ng-switch-when="asc" ng-click="pushSort(opt.ref, \'desc\')" class="ng-link ng-icon">\n              <i class="fa fa-sort-amount-asc"></i></a>\n            <a ng-switch-default ng-click="pushSort(opt.ref, \'desc\')" class="ng-link ng-icon">\n              <i class="fa fa-sort-amount-desc"></i></a>\n          </span>\n          <a ng-click="remove(axis, opt.ref)" ng-show="axis.multiple" class="ng-link ng-icon">\n            <i class="fa fa-times"></i></a>\n        </div>\n        <strong>{{opt.label}}</strong>\n        {{opt.subLabel}}\n      </td>\n    </tr>\n  </table>\n</div>\n\n\n<div class="panel panel-default">\n  <div class="panel-heading">\n    <strong>Filters</strong>\n\n    <div class="btn-group" dropdown ng-show="filterAttributes.length">\n      &mdash;\n      <a dropdown-toggle class="ng-link">add filter</a>\n      <ul class="dropdown-menu" role="menu">\n        <li ng-repeat="attr in filterAttributes">\n          <a ng-click="addFilter(attr)">\n            <strong>{{attr.label}}</strong>\n            {{attr.subLabel}}\n          </a>\n        </li>\n      </ul>\n    </div>\n  </div>\n  <table class="table table-panel">\n    <tbody ng-repeat="filter in filters">\n      <tr>\n        <td colspan="2">\n          <strong>{{filter.attr.label}}</strong>\n          {{filter.attr.subLabel}}\n        </td>\n        <td width="1%">\n          <span class="pull-right">\n            <a ng-click="removeFilter(filter)" class="ng-link">\n              <i class="fa fa-times"></i>\n            </a>\n          </span>\n        </td>\n      </tr>\n      <tr class="adjoined">\n        <td width="1%" class="middle">\n          is\n        </td>\n        <td width="95%">\n          <ui-select ng-model="filter.value" disable-search="false" on-select="setFilter(filter, $item, $model)">\n            <ui-select-match placeholder="Pick one...">{{$select.selected.label}}</ui-select-match>\n            <ui-select-choices repeat="v.value as v in filter.values | filter: $select.search track by $index">\n               <div ng-bind="v.label"></div>\n            </ui-select-choices>\n          </ui-select>\n        </td>\n        <td class="middle">\n        </td>\n      </tr>\n    </tbody>\n  </table>\n</div>\n\n')}]),angular.module("angular-cubes-templates/sankey.html",[]).run(["$templateCache",function(a){a.put("angular-cubes-templates/sankey.html",'<div class="table-cubes" ng-hide="queryLoaded">\n  <div class="alert alert-info">\n    <strong>You have not selected any data.</strong> Please choose a breakdown for\n    both sides of the flow diagram.\n  </div>\n</div>\n\n<div class="alert alert-warning" ng-show="cutoffWarning">\n  <strong>Too many links.</strong> The source and target you have selected\n  have many different links, only the {{cutoff}} biggest are shown.\n</div>\n\n<div class="sankey-cubes"></div>\n')}]),angular.module("angular-cubes-templates/treemap.html",[]).run(["$templateCache",function(a){a.put("angular-cubes-templates/treemap.html",'<div class="table-cubes" ng-hide="queryLoaded">\n  <div class="alert alert-info">\n    <strong>You have not selected any data.</strong> Please choose a breakdown for\n    your treemap.\n  </div>\n</div>\n\n<div class="alert alert-warning" ng-show="cutoffWarning">\n  <strong>Too many tiles.</strong> The breakdown you have selected contains many\n  different categories, only the {{cutoff}} biggest are shown.\n</div>\n\n<div class="treemap-cubes"></div>\n')}]),angular.module("angular-cubes-templates/workspace.html",[]).run(["$templateCache",function(a){a.put("angular-cubes-templates/workspace.html",'<cubes slicer="{{slicer}}" cube="{{cube}}" state="state">\n  <div class="row">\n    <div class="col-md-12">\n      <div class="btn-group spaced pull-right" role="group">\n        <a class="btn btn-default"\n          ng-class="{\'active\': view == \'facts\'}"\n          ng-click="setView(\'facts\')">\n          <i class="fa fa-table"></i> Items\n        </a>\n        <a class="btn btn-default"\n          ng-class="{\'active\': view == \'crosstab\'}"\n          ng-click="setView(\'crosstab\')">\n          <i class="fa fa-cubes"></i> Pivot table\n        </a>\n        <a class="btn btn-default"\n          ng-class="{\'active\': view == \'barchart\'}"\n          ng-click="setView(\'barchart\')">\n          <i class="fa fa-bar-chart"></i> Bar chart\n        </a>\n        <a class="btn btn-default"\n          ng-class="{\'active\': view == \'treemap\'}"\n          ng-click="setView(\'treemap\')">\n          <i class="fa fa-th-large"></i> Treemap\n        </a>\n        <a class="btn btn-default"\n          ng-class="{\'active\': view == \'sankey\'}"\n          ng-click="setView(\'sankey\')">\n          <i class="fa fa-random"></i> Flow\n        </a>\n      </div>\n    </div>\n  </div>\n  <div class="row">\n    <div class="col-md-9">\n      <div ng-if="view == \'crosstab\'">\n        <cubes-crosstab></cubes-crosstab>\n      </div>\n      <div ng-if="view == \'facts\'">\n        <cubes-facts></cubes-facts>\n      </div>\n      <div ng-if="view == \'treemap\'">\n        <cubes-treemap></cubes-treemap>\n      </div>\n      <div ng-if="view == \'barchart\'">\n        <cubes-barchart></cubes-barchart>\n      </div>\n      <div ng-if="view == \'sankey\'">\n        <cubes-sankey></cubes-sankey>\n      </div>\n    </div>\n    <div class="col-md-3">\n\n      <cubes-panel></cubes-panel>\n    </div>\n  </div>\n</cubes>\n')}]);